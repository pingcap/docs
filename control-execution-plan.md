---
title: Control Execution Plan
summary: この章では、TiDBにおける実行計画生成を制御する方法を紹介します。ヒントの使用、SQL計画管理、最適化ルールのブロックリストなどが含まれます。さらに、システム変数と「tidb_opt_fix_control」変数を変更することで、実行計画を制御することもできます。これらの方法は、クラスタのアップグレード後にオプティマイザの動作変更によって引き起こされるパフォーマンスの低下を防ぐのに役立ちます。
---

# 制御実行計画 {#control-execution-plan}

SQLチューニングの最初の2章では、TiDBの実行計画の理解方法と、TiDBが実行計画を生成する仕組みについて解説します。本章では、実行計画に問題があると判断した場合、実行計画の生成を制御するためにどのような手法が利用できるかを紹介します。本章では主に以下の3つの側面を取り上げます。

-   [オプティマイザヒント](/optimizer-hints.md)では、ヒントを使用して TiDB に実行プランを生成する方法を学習します。
-   しかし、ヒントはSQL文を介入的に変更します。場合によっては、ヒントを単純に挿入できないこともあります[SQLプラン管理](/sql-plan-management.md)では、TiDBが別の構文を用いて実行計画の生成を非介入的に制御する方法と、バックグラウンドで実行計画を自動的に進化させる方法について説明します。この方法は、バージョンアップやクラスタのパフォーマンス低下による実行計画の不安定性などの問題に対処するのに役立ちます。
-   最後に、 [最適化ルールのブロックリストと式のプッシュダウン](/blocklist-control-plan.md)でブロックリストの使用方法を学習します。

<CustomContent platform="tidb">

上記の方法に加えて、実行計画はいくつかのシステム変数の影響も受けます。これらの変数をシステムレベルまたはセッションレベルで変更することで、実行計画の生成を制御できます。TiDB v6.5.3およびv7.1.0以降、比較的特殊な変数[`tidb_opt_fix_control`](/system-variables.md#tidb_opt_fix_control-new-in-v653-and-v710)導入されました。この変数は複数の制御項目を受け入れることで、オプティマイザの動作をより細かく制御し、クラスターのアップグレード後にオプティマイザの動作が変更されることによるパフォーマンスの低下を防ぐことができます。詳細な説明については、 [オプティマイザー修正コントロール](/optimizer-fix-controls.md)を参照してください。

</CustomContent>

<CustomContent platform="tidb-cloud">

上記の方法に加えて、実行計画はいくつかのシステム変数の影響も受けます。これらの変数をシステムレベルまたはセッションレベルで変更することで、実行計画の生成を制御できます。TiDB v6.5.3およびv7.1.0以降、比較的特殊な変数[`tidb_opt_fix_control`](/system-variables.md#tidb_opt_fix_control-new-in-v653-and-v710)導入されました。この変数は複数の制御項目を受け入れることで、オプティマイザの動作をより細かく制御し、クラスターのアップグレード後にオプティマイザの動作が変更されることによるパフォーマンスの低下を防ぐことができます。詳細な説明については、 [オプティマイザー修正コントロール](https://docs.pingcap.com/tidb/v7.2/optimizer-fix-controls)を参照してください。

</CustomContent>
