---
title: TiSpark Deployment Topology
summary: 最小限の TiDB トポロジに基づくTiUPを使用した TiSpark のデプロイメント トポロジを学習します。
---

# TiSpark デプロイメントトポロジー {#tispark-deployment-topology}

> **警告：**
>
> TiUPクラスターにおけるTiSparkのサポートは非推奨です。使用は推奨され**ません**。

このドキュメントでは、TiSpark のデプロイメント トポロジと、最小クラスター トポロジに基づいて TiSpark をデプロイメントする方法について説明します。

TiSparkは、TiDB/TiKV上でApache Sparkを実行し、複雑なOLAPクエリに応答するために構築されたコンポーネントです。Sparkプラットフォームと分散型TiKVクラスターの両方の利点をTiDBにもたらし、TiDBをオンライントランザクションと分析の両方に対応するワンストップソリューションにします。

TiSparkアーキテクチャとその使用方法の詳細については、 [TiSpark ユーザーガイド](/tispark-overview.md)参照してください。

## トポロジ情報 {#topology-information}

| 実例             | カウント | 物理マシン構成                        | IP                                                           | コンフィグレーション                 |
| :------------- | :--- | :----------------------------- | :----------------------------------------------------------- | :------------------------- |
| TiDB           | 3    | 16 VCore 32GB * 1              | 10.0.1.1<br/> 10.0.1.2<br/> 10.0.1.3                         | デフォルトポート<br/>グローバルディレクトリ構成 |
| PD             | 3    | 4 VCore 8GB * 1                | 10.0.1.4<br/> 10.0.1.5<br/> 10.0.1.6                         | デフォルトポート<br/>グローバルディレクトリ構成 |
| TiKV           | 3    | 16 VCore 32GB 2TB（NVMe SSD）* 1 | 10.0.1.7<br/> 10.0.1.8<br/> 10.0.1.9                         | デフォルトポート<br/>グローバルディレクトリ構成 |
| ティスパーク         | 3    | 8 VCore 16GB * 1               | 10.0.1.21 (マスター)<br/> 10.0.1.22 (ワーカー)<br/> 10.0.1.23 (ワーカー) | デフォルトポート<br/>グローバルディレクトリ構成 |
| モニタリングとGrafana | 1    | 4 VCore 8GB * 1 500GB (SSD)    | 10.0.1.11                                                    | デフォルトポート<br/>グローバルディレクトリ構成 |

> **注記：**
>
> インスタンスのIPアドレスは例としてのみ示されています。実際の導入では、IPアドレスを実際のIPアドレスに置き換えてください。

## トポロジテンプレート {#topology-templates}

-   [シンプルなTiSparkトポロジテンプレート](https://github.com/pingcap/docs/blob/master/config-templates/simple-tispark.yaml)
-   [複雑な TiSpark トポロジ テンプレート](https://github.com/pingcap/docs/blob/master/config-templates/complex-tispark.yaml)

上記の TiDB クラスター トポロジ ファイルの構成項目の詳細については、 [TiUPを使用して TiDB をデプロイするためのトポロジコンフィグレーションファイル](/tiup/tiup-cluster-topology-reference.md)参照してください。

> **注記：**
>
> -   設定ファイルに`tidb`ユーザーを手動で作成する必要はありません。TiUPTiUPコンポーネントは、ターゲットマシンに`tidb`ユーザーを自動的に作成します。ユーザーをカスタマイズすることも、コントロールマシンと同じユーザーを維持することもできます。
> -   デプロイメント ディレクトリを相対パスとして構成すると、クラスターはユーザーのホーム ディレクトリにデプロイされます。

## 前提条件 {#prerequisites}

TiSparkはApache Sparkクラスターをベースとしているため、TiSparkを含むTiDBクラスターを起動する前に、TiSparkをデプロイするサーバーにJava Runtime Environment (JRE) 8がインストールされていることを確認する必要があります。JREがインストールされていない場合、TiSparkを起動できません。

TiUPはJREの自動インストールをサポートしていません。ご自身でインストールする必要があります。詳細なインストール手順については、 [ビルド済みの OpenJDK パッケージをダウンロードしてインストールする方法](https://openjdk.java.net/install/)ご覧ください。

JRE 8がデプロイメントサーバーに既にインストールされているものの、システムのデフォルトパッケージ管理ツールのパスに含まれていない場合は、トポロジ設定の`java_home`のパラメータを設定することで、使用するJRE環境のパスを指定できます。このパラメータは、システム環境変数`JAVA_HOME`に対応しています。
