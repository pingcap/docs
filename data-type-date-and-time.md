---
title: Date and Time Types
summary: Learn about the supported date and time types.
---

# 日付と時刻のタイプ {#date-and-time-types}

TiDBは、時間値を格納するためにすべてのMySQL [`YEAR`](#year-type)および時刻データ型をサポートし[`TIME`](#time-type) [`DATETIME`](#datetime-type) [`DATE`](#date-type) 、および[`TIMESTAMP`](#timestamp-type) 。詳細については、 [MySQLの日付と時刻のデータ型](https://dev.mysql.com/doc/refman/5.7/en/date-and-time-types.html)を参照してください。

これらの各タイプには有効な値の範囲があり、ゼロ値を使用して無効な値であることを示します。さらに、 `TIMESTAMP`および`DATETIME`タイプは、変更時に新しい時間値を自動的に生成できます。

日付と時刻の値の型を扱うときは、次の点に注意してください。

-   TiDBはさまざまな形式を解釈しようとしますが、日付部分は、月-日-年または日-月-年ではなく、年-月-日（たとえば、「1998-09-04」）の形式である必要があります。

-   日付の年の部分が2桁で指定されている場合、TiDBは[特定のルール](#two-digit-year-portion-contained-in-the-date)に基づいてそれを変換します。

-   コンテキストで数値が必要な場合、TiDBは日付または時刻の値を自動的に数値タイプに変換します。例えば：

    ```sql
    mysql> SELECT NOW(), NOW()+0, NOW(3)+0;
    +---------------------+----------------+--------------------+
    | NOW()               | NOW()+0        | NOW(3)+0           |
    +---------------------+----------------+--------------------+
    | 2012-08-15 09:28:00 | 20120815092800 | 20120815092800.889 |
    +---------------------+----------------+--------------------+
    ```

-   TiDBは、無効な値またはサポートされている範囲を超える値を、そのタイプのゼロ値に自動的に変換する場合があります。この動作は、SQLモードセットに依存します。例えば：

    ```sql
    mysql> show create table t1;
    +-------+---------------------------------------------------------------------------------------------------------+
    | Table | Create Table                                                                                            |
    +-------+---------------------------------------------------------------------------------------------------------+
    | t1    | CREATE TABLE `t1` (
      `a` time DEFAULT NULL
    ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_bin |
    +-------+---------------------------------------------------------------------------------------------------------+
    1 row in set (0.00 sec)

    mysql> select @@sql_mode;
    +-------------------------------------------------------------------------------------------------------------------------------------------+
    | @@sql_mode                                                                                                                                |
    +-------------------------------------------------------------------------------------------------------------------------------------------+
    | ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION |
    +-------------------------------------------------------------------------------------------------------------------------------------------+
    1 row in set (0.00 sec)

    mysql> insert into t1 values ('2090-11-32:22:33:44');
    ERROR 1292 (22007): Truncated incorrect time value: '2090-11-32:22:33:44'
    mysql> set @@sql_mode='';                                                                                                                                                                                                                     Query OK, 0 rows affected (0.01 sec)

    mysql> insert into t1 values ('2090-11-32:22:33:44');
    Query OK, 1 row affected, 1 warning (0.01 sec)

    mysql> select * from t1;
    +----------+
    | a        |
    +----------+
    | 00:00:00 |
    +----------+
    1 row in set (0.01 sec)
    ```

-   さまざまなSQLモードを設定すると、TiDBの動作が変わる可能性があります。

-   SQLモード`NO_ZERO_DATE`が有効になっていない場合、TiDBでは、 `DATE`列と`DATETIME`列の月または日をゼロ値にすることができます（例：「2009-00-00」または「2009-01-00」）。この日付型を関数で計算する場合、たとえば`DATE_SUB()`または`DATE_ADD()`の場合、結果が正しくない可能性があります。

-   デフォルトでは、TiDBはSQLモード`NO_ZERO_DATE`を有効にします。このモードは、「0000-00-00」などのゼロ値の保存を防ぎます。

次の表に、さまざまなタイプのゼロ値を示します。

| 日付型     | 「ゼロ」値                         |
| :------ | :---------------------------- |
| 日にち     | &#39;0000-00-00&#39;          |
| 時間      | &#39;00:00:00&#39;            |
| 日付時刻    | &#39;0000-00-00 00:00:00&#39; |
| タイムスタンプ | &#39;0000-00-00 00:00:00&#39; |
| 年       | 0000                          |

無効な`DATE`の`DATETIME`は、SQLモードでそのような使用が許可されている場合、対応するタイプのゼロ値（&#39;0000-00-00&#39;または&#39;0000-00-00 00:00:00&#39;）に自動的に変換され`TIMESTAMP` 。

## サポートされているタイプ {#supported-types}

### <code>DATE</code>型 {#code-date-code-type}

`DATE`には日付部分のみが含まれ、時間部分は含まれず、 `YYYY-MM-DD`の形式で表示されます。サポートされる範囲は「0000-01-01」から「9999-12-31」です。

```sql
DATE
```

### <code>TIME</code>タイプ {#code-time-code-type}

`TIME`タイプの場合、形式は`HH:MM:SS[.fraction]`で、有効な値の範囲は「-838：59：59.000000」から「838：59：59.000000」です。 `TIME`は、1日の時間を示すだけでなく、2つのイベント間の時間間隔を示すためにも使用されます。分数秒の精度を指定するために、0〜6の範囲のオプションの`fsp`値を指定できます。省略した場合、デフォルトの精度は0です。

```sql
TIME[(fsp)]
```

> **ノート：**
>
> `TIME`の省略形に注意してください。たとえば、「11:12」は「00:11:12」ではなく「11:12:00」を意味します。ただし、「1112」は「00:11:12」を意味します。これらの違いは、 `:`文字の有無によって発生します。

### <code>DATETIME</code>タイプ {#code-datetime-code-type}

`DATETIME`には、日付部分と時間部分の両方が含まれます。有効な値の範囲は、「0000-01-01 00：00：00.000000」から「9999-12-3123：59：59.999999」です。

TiDBは`DATETIME`の値を`YYYY-MM-DD HH:MM:SS[.fraction]`の形式で表示しますが、文字列または数値のいずれかを使用して`DATETIME`の列に値を割り当てることができます。分数秒の精度を指定するために、0〜6の範囲のオプションのfsp値を指定できます。省略した場合、デフォルトの精度は0です。

```sql
DATETIME[(fsp)]
```

### <code>TIMESTAMP</code>タイプ {#code-timestamp-code-type}

`TIMESTAMP`には、日付部分と時間部分の両方が含まれます。有効な値の範囲は、UTC時間で「1970-01-0100：00：01.000000」から「2038-01-1903：14：07.999999」です。分数秒の精度を指定するために、0〜6の範囲のオプションのfsp値を指定できます。省略した場合、デフォルトの精度は0です。

`TIMESTAMP`では、月の部分または日の部分にゼロを表示することは許可されていません。唯一の例外は、ゼロ値自体&#39;0000-00-0000:00:00&#39;です。

```sql
TIMESTAMP[(fsp)]
```

#### タイムゾーンの処理 {#timezone-handling}

`TIMESTAMP`が格納される場合、TiDBは`TIMESTAMP`の値を現在のタイムゾーンからUTCタイムゾーンに変換します。 `TIMESTAMP`を取得する場合、TiDBは保存されている`TIMESTAMP`の値をUTCタイムゾーンから現在のタイムゾーンに変換します（注： `DATETIME`はこの方法では処理されません）。各接続のデフォルトのタイムゾーンはサーバーのローカルタイムゾーンであり、環境変数`time_zone`で変更できます。

> **警告：**
>
> MySQLと同様に、 `TIMESTAMP`のデータ型は[2038年問題](https://en.wikipedia.org/wiki/Year_2038_problem)の影響を受けます。 2038を超える可能性のある値を格納する場合は、代わりに`DATETIME`タイプの使用を検討してください。

### <code>YEAR</code>タイプ {#code-year-code-type}

`YEAR`タイプは、「YYYY」の形式で指定されます。サポートされている値の範囲は1901〜2155、またはゼロ値0000です。

```sql
YEAR[(4)]
```

`YEAR`は、次のフォーマット規則に従います。

-   4桁の数字の範囲は1901年から2155年です
-   4桁の文字列の範囲は「1901」から「2155」です。
-   1桁または2桁の数字の範囲は1〜99です。したがって、1-69は2001-2069に変換され、70-99は1970-1999に変換されます。
-   1桁または2桁の文字列の範囲は「0」から「99」です。
-   値0は0000と見なされ、文字列「0」または「00」は2000と見なされます。

無効な`YEAR`の値は自動的に0000に変換されます（ユーザーが`NO_ZERO_DATE` SQLモードを使用していない場合）。

## <code>TIMESTAMP</code>と<code>DATETIME</code>の自動初期化と更新 {#automatic-initialization-and-update-of-code-timestamp-code-and-code-datetime-code}

`TIMESTAMP`または`DATETIME`の値タイプの列は、現在の時刻に自動的に初期化または更新できます。

テーブル内の値タイプが`TIMESTAMP`または`DATETIME`の列の場合、デフォルト値または自動更新値を現在のタイムスタンプとして設定できます。

これらのプロパティは、列の定義時に`DEFAULT CURRENT_TIMESTAMP`と`ON UPDATE CURRENT_TIMESTAMP`を設定することで設定できます。 DEFAULTは、 `DEFAULT 0`や`DEFAULT '2000-01-01 00:00:00'`などの特定の値として設定することもできます。

```sql
CREATE TABLE t1 (
    ts TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    dt DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);
```

`NOT NULL`として指定されていない限り、 `DATETIME`のデフォルト値は`NULL`です。後者の場合、デフォルト値が設定されていない場合、デフォルト値は0です。

```sql
CREATE TABLE t1 (
    dt1 DATETIME ON UPDATE CURRENT_TIMESTAMP,         -- default NULL
    dt2 DATETIME NOT NULL ON UPDATE CURRENT_TIMESTAMP -- default 0
);
```

## 時間値の小数部分 {#decimal-part-of-time-value}

`DATETIME`と`TIMESTAMP`の値には、ミリ秒単位で正確な最大6桁の小数部分を含めることができます。 `DATETIME`または`TIMESTAMP`タイプの列では、小数部分が破棄されるのではなく保存されます。小数部の場合、値は「YYYY-MM-DD HH：MM：SS [.fraction]」の形式で、小数部の範囲は000000〜999999です。小数部と小数部を区切るには小数点を使用する必要があります。休み。

-   `type_name(fsp)`を使用して、小数精度をサポートする列を定義し`TIMESTAMP` `type_name`は`TIME` 、または`DATETIME`です。例えば、

    ```sql
    CREATE TABLE t1 (t TIME(3), dt DATETIME(6));
    ```

    `fsp`は0から6の範囲でなければなりません。

    `0`は、小数部がないことを意味します。 `fsp`を省略した場合、デフォルトは0です。

-   小数`TIMESTAMP` `TIME` `DATETIME`するときに、小数部の桁数が少なすぎる、または多すぎる場合は、状況に応じて丸めが必要になることがあります。例えば：

    ```sql
    mysql> CREATE TABLE fractest( c1 TIME(2), c2 DATETIME(2), c3 TIMESTAMP(2) );
    Query OK, 0 rows affected (0.33 sec)

    mysql> INSERT INTO fractest VALUES
         > ('17:51:04.777', '2014-09-08 17:51:04.777',   '2014-09-08 17:51:04.777');
    Query OK, 1 row affected (0.03 sec)

    mysql> SELECT * FROM fractest;
    +-------------|------------------------|------------------------+
    | c1          | c2                     | c3                     |
    +-------------|------------------------|------------------------+
    | 17:51:04.78 | 2014-09-08 17:51:04.78 | 2014-09-08 17:51:04.78 |
    +-------------|------------------------|------------------------+
    1 row in set (0.00 sec)
    ```

## 日付と時刻のタイプ間の変換 {#conversions-between-date-and-time-types}

日付と時刻のタイプを変換する必要がある場合があります。ただし、一部の変換は情報の損失につながる可能性があります。たとえば、 `DATE` 、および`DATETIME`の値はすべて、それぞれ独自の範囲を持って`TIMESTAMP`ます。 `TIMESTAMP`は、UTC時間で1970年より前、またはUTC時間「2038-01-1903:14:07」より遅くてはなりません。この規則に基づくと、「1968-01-01」は有効な日付値`DATE`または`DATETIME`ですが、 `TIMESTAMP`に変換されると0になります。

`DATE`の変換：

-   `DATE`が`DATETIME`または`TIMESTAMP`に変換されると、DATEには時間情報が含まれないため、時間部分「00:00:00」が追加されます。
-   `DATE`を`TIME`に変換すると、結果は「00:00:00」になります。

`DATETIME`または`TIMESTAMP`の変換：

-   `DATETIME`または`TIMESTAMP`が`DATE`に変換されると、時間と小数部分は破棄されます。たとえば、「1999-12-31 23：59：59.499」は「1999-12-31」に変換されます
-   `DATETIME`または`TIMESTAMP`がTIMEに変換されると、 `TIME`には日付情報が含まれないため、日付部分は破棄されます。

`TIME`を他の時刻と日付の形式に変換すると、日付部分は自動的に`CURRENT_DATE()`として指定されます。最終的に変換された結果は、 `TIME`と`CURRENT_DATE()`で構成される日付です。つまり、TIMEの値が「00:00:00」から「23:59:59」の範囲を超えている場合、変換された日付部分は現在の日付を示しません。

`TIME`を`DATE`に変換すると、プロセスは同様になり、時間部分は破棄されます。

`CAST()`関数を使用すると、値を`DATE`型に明示的に変換できます。例えば：

```sql
date_col = CAST(datetime_col AS DATE)
```

`TIME`と`DATETIME`を数値形式に変換します。例えば：

```sql
mysql> SELECT CURTIME(), CURTIME()+0, CURTIME(3)+0;
+-----------|-------------|--------------+
| CURTIME() | CURTIME()+0 | CURTIME(3)+0 |
+-----------|-------------|--------------+
| 09:28:00  |       92800 |    92800.887 |
+-----------|-------------|--------------+
mysql> SELECT NOW(), NOW()+0, NOW(3)+0;
+---------------------|----------------|--------------------+
| NOW()               | NOW()+0        | NOW(3)+0           |
+---------------------|----------------|--------------------+
| 2012-08-15 09:28:00 | 20120815092800 | 20120815092800.889 |
+---------------------|----------------|--------------------+
```

## 日付に含まれる2桁の年の部分 {#two-digit-year-portion-contained-in-the-date}

日付に含まれる2桁の年の部分は、実際の年を明示的に示すものではなく、あいまいです。

`DATETIME` 、および`DATE`タイプの場合、 `TIMESTAMP`は次のルールに従って、あいまいさを排除します。

-   01から69までの値は、2001から2069までの値に変換されます
-   70〜99の値は、1970〜1999の値に変換されます

これらのルールは、 `YEAR`つのタイプにも適用されますが、1つの例外があります。

数字の`00`を`YEAR(4)`に挿入すると、結果は2000ではなく0000になります。

結果を2000にする場合は、値を2000に指定します。

`MIN()`や`MAX()`などの一部の関数では、2桁の年の部分が正しく計算されない場合があります。これらの関数については、4桁のフォーマットスイートの方が適しています。
