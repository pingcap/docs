---
title: Optimize Configuration of DM
summary: データ移行タスクの構成を最適化して、データ移行のパフォーマンスを向上させる方法を学習します。
---

# DMのコンフィグレーションを最適化する {#optimize-configuration-of-dm}

このドキュメントでは、データ移行タスクの構成を最適化して、データ移行のパフォーマンスを向上させる方法を紹介します。

## 完全なデータのエクスポート {#full-data-export}

`mydumpers`は、フルデータエクスポートに関連する設定項目です。このセクションでは、パフォーマンス関連のオプションの設定方法について説明します。

### <code>rows</code> {#code-rows-code}

`rows`オプションを設定すると、マルチスレッドを使用して単一テーブルから同時にデータをエクスポートできます。3 `rows`値は、エクスポートされる各チャンクに含まれる行の最大数です。このオプションを有効にすると、MySQL 単一テーブルのデータを同時にエクスポートする際に、DM は分割ベンチマークとして列を選択します。この列は、主キー列、一意のインデックス列、通常のインデックス列（優先度の高いものから`BIGINT`ものの順）のいずれかになります。この列`MEDIUMINT`整数型（例： `INT` ）であることを確認してください。

`rows`の値は 10000 まで設定できます。この値は、テーブルの総行数とデータベースのパフォーマンスに応じて変更できます。また、同時実行スレッド数を制御するには`threads`設定する必要があります。デフォルトでは`threads`の値は 4 です。この値は必要に応じて調整できます。

### <code>chunk-filesize</code> {#code-chunk-filesize-code}

フルバックアップ中、DMは各テーブルのデータを`chunk-filesize`オプションの値に応じて複数のチャンクに分割します。各チャンクは約`chunk-filesize`のサイズのファイルに保存されます。このようにしてデータは複数のファイルに分割され、DM Loadユニットの並列処理を利用してインポート速度を向上させることができます。このオプションのデフォルト値は64（MB）です。通常、このオプションを設定する必要はありません。設定する場合は、フルデータのサイズに応じてこのオプションの値を調整してください。

> **注記：**
>
> -   移行タスクの作成後は、値`mydumpers`を更新できません。タスクを作成する前に、各オプションの値を確認してください。値を更新する必要がある場合は、dmctl を使用してタスクを停止し、設定ファイルを更新してから、タスクを再作成してください。
> -   `mydumpers` . `threads` 、簡単にするために`mydumper-thread`構成項目に置き換えることができます。
> -   `rows`設定されている場合、DM は`chunk-filesize`の値を無視します。

## 完全なデータインポート {#full-data-import}

`loaders`はフルデータインポートに関連する設定項目です。このセクションでは、パフォーマンス関連のオプションの設定方法について説明します。

### <code>pool-size</code> {#code-pool-size-code}

`pool-size`オプションは、DM Load ユニット内のスレッド数を決定します。デフォルト値は 16 です。通常、このオプションを設定する必要はありません。設定する場合は、フルデータのサイズとデータベースのパフォーマンスに応じて、このオプションの値を調整してください。

> **注記：**
>
> -   移行タスクの作成後は、値`loaders`を更新できません。タスクを作成する前に、各オプションの値を確認してください。値を更新する必要がある場合は、dmctl を使用してタスクを停止し、設定ファイルを更新してから、タスクを再作成してください。
> -   `loaders` . `pool-size` 、簡単にするために`loader-thread`構成項目に置き換えることができます。

## 増分データレプリケーション {#incremental-data-replication}

`syncers`は増分データレプリケーションに関連する設定項目です。このセクションでは、パフォーマンス関連のオプションの設定方法について説明します。

### <code>worker-count</code> {#code-worker-count-code}

`worker-count` 、DM SyncユニットにおけるDMLの同時レプリケーションのスレッド数を指定します。デフォルト値は16です。データレプリケーションを高速化するには、このオプションの値を適切に増やしてください。

### <code>batch</code> {#code-batch-code}

`batch` 、DM Sync ユニット中にデータが下流データベースにレプリケートされる際に、各トランザクションに含まれる DML の数を決定します。デフォルト値は 100 です。通常、このオプションの値を変更する必要はありません。

> **注記：**
>
> -   レプリケーションタスクの作成後は、値`syncers`を更新できません。タスクを作成する前に、各オプションの値を確認してください。値を更新する必要がある場合は、dmctl を使用してタスクを停止し、設定ファイルを更新してから、タスクを再作成してください。
> -   `syncers` . `worker-count` 、簡単にするために`syncer-thread`構成項目に置き換えることができます。
> -   `worker-count`と`batch`の値は実際のシナリオに応じて変更できます。例えば、DMと下流データベース間のネットワーク遅延が大きい場合は、 `worker-count`の値を増やし、 `batch`の値を適切に減らすことができます。
