---
title: JSON Functions That Search JSON Values
summary: Learn about JSON functions that search JSON values.
---

# ç”¨äºæœç´¢ JSON å€¼çš„ JSON å‡½æ•°

TiDB æ”¯æŒå¤§å¤šæ•° MySQL 8.0 ä¸­ [ç”¨äºæœç´¢ JSON å€¼çš„ JSON å‡½æ•°](https://dev.mysql.com/doc/refman/8.0/en/json-search-functions.html)ã€‚

## `JSON_CONTAINS()`

`JSON_CONTAINS(json_doc, candidate [,path])` å‡½æ•°é€šè¿‡è¿”å› `1` æˆ– `0`ï¼Œè¡¨ç¤ºç»™å®šçš„ `candidate` JSON æ–‡æ¡£æ˜¯å¦åŒ…å«åœ¨ç›®æ ‡ JSON æ–‡æ¡£ä¸­ã€‚

ç¤ºä¾‹ï¼š

æ­¤å¤„ `a` è¢«åŒ…å«åœ¨ç›®æ ‡æ–‡æ¡£ä¸­ã€‚

```sql
SELECT JSON_CONTAINS('["a","b","c"]','"a"');
```

```
+--------------------------------------+
| JSON_CONTAINS('["a","b","c"]','"a"') |
+--------------------------------------+
|                                    1 |
+--------------------------------------+
1 row in set (0.00 sec)
```

æ­¤å¤„ `e` æœªè¢«åŒ…å«åœ¨ç›®æ ‡æ–‡æ¡£ä¸­ã€‚

```sql
SELECT JSON_CONTAINS('["a","b","c"]','"e"');
```

```
+--------------------------------------+
| JSON_CONTAINS('["a","b","c"]','"e"') |
+--------------------------------------+
|                                    0 |
+--------------------------------------+
1 row in set (0.00 sec)
```

æ­¤å¤„ `{"foo": "bar"}` è¢«åŒ…å«åœ¨ç›®æ ‡æ–‡æ¡£ä¸­ã€‚

```sql
SELECT JSON_CONTAINS('{"foo": "bar", "aaa": 5}','{"foo": "bar"}');
```

```
+------------------------------------------------------------+
| JSON_CONTAINS('{"foo": "bar", "aaa": 5}','{"foo": "bar"}') |
+------------------------------------------------------------+
|                                                          1 |
+------------------------------------------------------------+
1 row in set (0.00 sec)
```

æ­¤å¤„ `"bar"` æœªè¢«åŒ…å«åœ¨ç›®æ ‡æ–‡æ¡£çš„æ ¹èŠ‚ç‚¹ä¸­ã€‚

```sql
SELECT JSON_CONTAINS('{"foo": "bar", "aaa": 5}','"bar"');
```

```
+---------------------------------------------------+
| JSON_CONTAINS('{"foo": "bar", "aaa": 5}','"bar"') |
+---------------------------------------------------+
|                                                 0 |
+---------------------------------------------------+
1 row in set (0.00 sec)
```

æ­¤å¤„ `"bar"` è¢«åŒ…å«åœ¨ç›®æ ‡æ–‡æ¡£çš„ `$.foo` å±æ€§ä¸­ã€‚

```sql
SELECT JSON_CONTAINS('{"foo": "bar", "aaa": 5}','"bar"', '$.foo');
```

```
+------------------------------------------------------------+
| JSON_CONTAINS('{"foo": "bar", "aaa": 5}','"bar"', '$.foo') |
+------------------------------------------------------------+
|                                                          1 |
+------------------------------------------------------------+
1 row in set (0.00 sec)
```

## `JSON_CONTAINS_PATH()`

`JSON_CONTAINS_PATH(json_doc, all_or_one, path [,path, ...])` å‡½æ•°é€šè¿‡è¿”å› `0` æˆ– `1`ï¼Œè¡¨ç¤º JSON æ–‡æ¡£åœ¨ç»™å®šè·¯å¾„æˆ–å¤šä¸ªè·¯å¾„ä¸Šæ˜¯å¦åŒ…å«æ•°æ®ã€‚

ç¤ºä¾‹ï¼š

æ­¤å¤„æ–‡æ¡£åŒ…å« `$.foo`ã€‚

```sql
SELECT JSON_CONTAINS_PATH('{"foo": "bar", "aaa": 5}','all','$.foo');
```

```
+--------------------------------------------------------------+
| JSON_CONTAINS_PATH('{"foo": "bar", "aaa": 5}','all','$.foo') |
+--------------------------------------------------------------+
|                                                            1 |
+--------------------------------------------------------------+
1 row in set (0.00 sec)
```

æ­¤å¤„æ–‡æ¡£ä¸åŒ…å« `$.bar`ã€‚

```sql
SELECT JSON_CONTAINS_PATH('{"foo": "bar", "aaa": 5}','all','$.bar');
```

```
+--------------------------------------------------------------+
| JSON_CONTAINS_PATH('{"foo": "bar", "aaa": 5}','all','$.bar') |
+--------------------------------------------------------------+
|                                                            0 |
+--------------------------------------------------------------+
1 row in set (0.00 sec)
```

æ­¤å¤„æ–‡æ¡£åŒæ—¶åŒ…å« `$.foo` å’Œ `$.aaa`ã€‚

```sql
SELECT JSON_CONTAINS_PATH('{"foo": "bar", "aaa": 5}','all','$.foo', '$.aaa');
```

```
+-----------------------------------------------------------------------+
| JSON_CONTAINS_PATH('{"foo": "bar", "aaa": 5}','all','$.foo', '$.aaa') |
+-----------------------------------------------------------------------+
|                                                                     1 |
+-----------------------------------------------------------------------+
1 row in set (0.00 sec)
```

## `JSON_EXTRACT()`

`JSON_EXTRACT(json_doc, path[, path] ...)` å‡½æ•°ç”¨äºä» JSON æ–‡æ¡£ä¸­æå–æ•°æ®ï¼Œæå–çš„éƒ¨åˆ†ç”± `path` å‚æ•°æŒ‡å®šã€‚

```sql
SELECT JSON_EXTRACT('{"foo": "bar", "aaa": 5}', '$.foo');
```

```
+---------------------------------------------------+
| JSON_EXTRACT('{"foo": "bar", "aaa": 5}', '$.foo') |
+---------------------------------------------------+
| "bar"                                             |
+---------------------------------------------------+
1 row in set (0.00 sec)
```

## `->`

`column->path` å‡½æ•°è¿”å› `column` ä¸­ä¸ `path` å‚æ•°åŒ¹é…çš„æ•°æ®ã€‚å®ƒæ˜¯ [`JSON_EXTRACT()`](#json_extract) çš„åˆ«åã€‚

```sql
SELECT
    j->'$.foo',
    JSON_EXTRACT(j, '$.foo')
FROM (
    SELECT
        '{"foo": "bar", "aaa": 5}' AS j
    ) AS tbl;
```

```
+------------+--------------------------+
| j->'$.foo' | JSON_EXTRACT(j, '$.foo') |
+------------+--------------------------+
| "bar"      | "bar"                    |
+------------+--------------------------+
1 row in set (0.00 sec)
```

## `->>`

`column->>path` å‡½æ•°ä¼šå¯¹ `column` ä¸­ä¸ `path` å‚æ•°åŒ¹é…çš„æ•°æ®è¿›è¡Œå»å¼•å·æ“ä½œã€‚å®ƒç­‰ä»·äº `JSON_UNQUOTE(JSON_EXTRACT(doc, path_literal))`ã€‚

```sql
SELECT
    j->'$.foo',
    JSON_EXTRACT(j, '$.foo')
    j->>'$.foo',
    JSON_UNQUOTE(JSON_EXTRACT(j, '$.foo'))
FROM (
    SELECT
        '{"foo": "bar", "aaa": 5}' AS j
    ) AS tbl;
```

```
+------------+--------------------------+-------------+----------------------------------------+
| j->'$.foo' | JSON_EXTRACT(j, '$.foo') | j->>'$.foo' | JSON_UNQUOTE(JSON_EXTRACT(j, '$.foo')) |
+------------+--------------------------+-------------+----------------------------------------+
| "bar"      | "bar"                    | bar         | bar                                    |
+------------+--------------------------+-------------+----------------------------------------+
1 row in set (0.00 sec)
```

## `JSON_KEYS()`

`JSON_KEYS(json_doc [,path])` å‡½æ•°ä»¥ JSON æ•°ç»„çš„å½¢å¼è¿”å› JSON å¯¹è±¡çš„é¡¶å±‚é”®åã€‚å¦‚æœæŒ‡å®šäº† `path` å‚æ•°ï¼Œåˆ™è¿”å›é€‰å®šè·¯å¾„ä¸‹çš„é¡¶å±‚é”®åã€‚

ç¤ºä¾‹ï¼š

ä»¥ä¸‹ç¤ºä¾‹è¿”å› JSON æ–‡æ¡£ä¸­çš„ä¸¤ä¸ªé¡¶å±‚é”®åã€‚

```sql
SELECT JSON_KEYS('{"name": {"first": "John", "last": "Doe"}, "type": "Person"}');
```

```
+---------------------------------------------------------------------------+
| JSON_KEYS('{"name": {"first": "John", "last": "Doe"}, "type": "Person"}') |
+---------------------------------------------------------------------------+
| ["name", "type"]                                                          |
+---------------------------------------------------------------------------+
1 row in set (0.00 sec)
```

ä»¥ä¸‹ç¤ºä¾‹è¿”å› JSON æ–‡æ¡£ä¸­ `$.name` è·¯å¾„ä¸‹çš„é¡¶å±‚é”®åã€‚

```sql
SELECT JSON_KEYS('{"name": {"first": "John", "last": "Doe"}, "type": "Person"}', '$.name');
```

```
+-------------------------------------------------------------------------------------+
| JSON_KEYS('{"name": {"first": "John", "last": "Doe"}, "type": "Person"}', '$.name') |
+-------------------------------------------------------------------------------------+
| ["first", "last"]                                                                   |
+-------------------------------------------------------------------------------------+
1 row in set (0.00 sec)
```

## `JSON_SEARCH()`

`JSON_SEARCH(json_doc, one_or_all, str)` å‡½æ•°åœ¨ JSON æ–‡æ¡£ä¸­æŸ¥æ‰¾å­—ç¬¦ä¸²çš„ä¸€ä¸ªæˆ–æ‰€æœ‰åŒ¹é…é¡¹ã€‚

ç¤ºä¾‹ï¼š

åœ¨ä»¥ä¸‹ç¤ºä¾‹ä¸­ï¼Œä½ å¯ä»¥æŸ¥æ‰¾ `cc` çš„ç¬¬ä¸€ä¸ªç»“æœï¼Œå®ƒä½äº `a` æ•°ç»„çš„ç´¢å¼• 2 ä½ç½®ã€‚

```sql
SELECT JSON_SEARCH('{"a": ["aa", "bb", "cc"], "b": ["cc", "dd"]}','one','cc');
```

```
+------------------------------------------------------------------------+
| JSON_SEARCH('{"a": ["aa", "bb", "cc"], "b": ["cc", "dd"]}','one','cc') |
+------------------------------------------------------------------------+
| "$.a[2]"                                                               |
+------------------------------------------------------------------------+
1 row in set (0.00 sec)
```

ç°åœ¨ä½ å°† `one_or_all` è®¾ç½®ä¸º `all`ï¼Œå¯ä»¥è·å–æ‰€æœ‰ç»“æœï¼Œè€Œä¸ä»…ä»…æ˜¯ç¬¬ä¸€ä¸ªç»“æœã€‚

```sql
SELECT JSON_SEARCH('{"a": ["aa", "bb", "cc"], "b": ["cc", "dd"]}','all','cc');
```

```
+------------------------------------------------------------------------+
| JSON_SEARCH('{"a": ["aa", "bb", "cc"], "b": ["cc", "dd"]}','all','cc') |
+------------------------------------------------------------------------+
| ["$.a[2]", "$.b[0]"]                                                   |
+------------------------------------------------------------------------+
1 row in set (0.01 sec)
```

## `MEMBER OF()`

`str MEMBER OF (json_array)` å‡½æ•°ç”¨äºåˆ¤æ–­ä¼ å…¥çš„å€¼ `str` æ˜¯å¦ä¸º `json_array` çš„å…ƒç´ ï¼Œå¦‚æœæ˜¯åˆ™è¿”å› `1`ï¼Œå¦åˆ™è¿”å› `0`ã€‚å¦‚æœä»»ä¸€å‚æ•°ä¸º `NULL`ï¼Œåˆ™è¿”å› `NULL`ã€‚

```
SELECT 'ğŸ' MEMBER OF ('["ğŸ","ğŸ¥¥","ğŸ¥­"]') AS 'Contains pineapple';
```

```
+--------------------+
| Contains pineapple |
+--------------------+
|                  1 |
+--------------------+
1 row in set (0.00 sec)

```

## `JSON_OVERLAPS()`

`JSON_OVERLAPS(json_doc, json_doc)` å‡½æ•°ç”¨äºåˆ¤æ–­ä¸¤ä¸ª JSON æ–‡æ¡£æ˜¯å¦æœ‰é‡å éƒ¨åˆ†ã€‚å¦‚æœæœ‰é‡å ï¼Œåˆ™è¿”å› `1`ï¼›å¦åˆ™è¿”å› `0`ã€‚å¦‚æœä»»ä¸€å‚æ•°ä¸º `NULL`ï¼Œåˆ™è¿”å› `NULL`ã€‚

ç¤ºä¾‹ï¼š

ä»¥ä¸‹ç¤ºä¾‹æ˜¾ç¤ºæ²¡æœ‰é‡å ï¼Œå› ä¸ºæ•°ç»„å€¼çš„å…ƒç´ æ•°é‡ä¸åŒã€‚

```sql
SELECT JSON_OVERLAPS(
    '{"languages": ["Go","Rust","C#"]}',
    '{"languages": ["Go","Rust"]}'
) AS 'Overlaps';
```

```
+----------+
| Overlaps |
+----------+
|        0 |
+----------+
1 row in set (0.00 sec)
```

ä»¥ä¸‹ç¤ºä¾‹æ˜¾ç¤ºä¸¤ä¸ª JSON æ–‡æ¡£å®Œå…¨ç›¸åŒï¼Œå› æ­¤æœ‰é‡å ã€‚

```sql
SELECT JSON_OVERLAPS(
    '{"languages": ["Go","Rust","C#"]}',
    '{"languages": ["Go","Rust","C#"]}'
) AS 'Overlaps';
```

```
+----------+
| Overlaps |
+----------+
|        1 |
+----------+
1 row in set (0.00 sec)
```

ä»¥ä¸‹ç¤ºä¾‹æ˜¾ç¤ºå­˜åœ¨é‡å ï¼Œå°½ç®¡ç¬¬äºŒä¸ªæ–‡æ¡£æœ‰é¢å¤–çš„å±æ€§ã€‚

```sql
SELECT JSON_OVERLAPS(
    '{"languages": ["Go","Rust","C#"]}',
    '{"languages": ["Go","Rust","C#"], "arch": ["arm64"]}'
) AS 'Overlaps';
```

```
+----------+
| Overlaps |
+----------+
|        1 |
+----------+
1 row in set (0.00 sec)
```

## å‚è§

- [JSON å‡½æ•°æ€»è§ˆ](/functions-and-operators/json-functions.md)
- [JSON æ•°æ®ç±»å‹](/data-type-json.md)
