---
title: Determine Your TiDB Size
summary: Learn how to determine the size of your TiDB Cloud cluster.
---

# TiDBサイズを決定する {#determine-your-tidb-size}

このドキュメントでは、TiDBクラスタのサイズを決定する方法について説明します。

## サイズTiDB {#size-tidb}

TiDBはコンピューティング専用であり、データを保存しません。水平方向にスケーラブルです。

TiDBのvCPUサイズとノード数の両方を構成できます。

### TiDBvCPUサイズ {#tidb-vcpu-size}

サポートされているvCPUサイズには、4つのvCPU（ベータ）、8つのvCPU、および16のvCPUが含まれます。

> **ノート：**
>
> TiDBのvCPUサイズが**4vCPU（ベータ）**に設定されている場合は、次の制限に注意してください。
>
> -   TiDBのノード数は1または2にのみ設定でき、TiKVのノード数は3に固定されています。
> -   TiDBは、4vCPUのTiKVでのみ使用できます。
> -   TiFlash<sup>ベータ版</sup>は利用できません。

### TiDBノードの数量 {#tidb-node-quantity}

高可用性を実現するには、 TiDB Cloudクラスタごとに少なくとも2つのTiDBノードを構成することをお勧めします。

TiDBサイズを決定する方法の詳細については、 [パフォーマンスリファレンス](#performance-reference)を参照してください。

## サイズTiKV {#size-tikv}

TiKVはデータの保存を担当します。水平方向にスケーラブルです。

TiKVのvCPUサイズ、ノード数、およびストレージサイズを構成できます。

### TiKVvCPUサイズ {#tikv-vcpu-size}

サポートされているサイズには、4 vCPU（ベータ）、8 vCPU、および16vCPUが含まれます。

> **ノート：**
>
> TiKVのvCPUサイズが**4vCPU（ベータ）**に設定されている場合は、次の制限に注意してください。
>
> -   TiDBのノード数は1または2にのみ設定でき、TiKVのノード数は3に固定されています。
> -   TiKVは、4vCPUのTiDBでのみ使用できます。
> -   TiFlash<sup>ベータ版</sup>は利用できません。

### TiKVノードの数量 {#tikv-node-quantity}

TiKVノードの数は**少なくとも1セット（3つの異なる使用可能ゾーンに3つのノード）で**ある必要があります。

TiDB Cloudは、耐久性と高可用性を実現するために、選択したリージョンのすべてのアベイラビリティーゾーン（少なくとも3つ）にTiKVノードを均等にデプロイします。通常の3レプリカのセットアップでは、データはすべてのアベイラビリティーゾーンのTiKVノードに均等に分散され、各TiKVノードのディスクに保持されます。

> **ノート：**
>
> TiDBクラスタをスケーリングすると、3つのアベイラビリティーゾーンのノードが同時に増減します。ニーズに基づいてTiDBクラスタをスケールインまたはスケールアウトする方法については、 [TiDBクラスターをスケーリングする](/tidb-cloud/scale-tidb-cluster.md)を参照してください。

TiKVノードの最小数： `ceil(compressed size of your data ÷ one TiKV capacity) × the number of replicas`

MySQLダンプファイルのサイズが5TBで、TiDB圧縮率が70％であるとすると、必要なストレージは3584GBです。

たとえば、AWSの各TiKVノードのストレージサイズを1024 GBに設定した場合、必要なTiKVノードの数は次のようになります。

TiKVノードの最小数： `ceil(3584 ÷ 1024) × 3 = 12`

TiKVサイズを決定する方法の詳細については、 [パフォーマンスリファレンス](#performance-reference)を参照してください。

### TiKVストレージサイズ {#tikv-storage-size}

TiKVストレージサイズは、クラスタを作成または復元する場合にのみ構成できます。

## サイズTiFlash<sup>ベータ</sup> {#size-tiflash-sup-beta-sup}

TiFlash<sup>ベータ版</sup>は、TiKVからのデータをリアルタイムで同期し、箱から出してすぐにリアルタイム分析ワークロードをサポートします。水平方向にスケーラブルです。

TiFlash<sup>ベータ版</sup>のvCPUサイズ、ノード数、およびストレージサイズを構成できます。

### TiFlash<sup>ベータ</sup>vCPUサイズ {#tiflash-sup-beta-sup-vcpu-size}

サポートされているvCPUサイズには、8個のvCPUと16個のvCPUが含まれます。

TiDBまたはTiKVのvCPUサイズが**4vCPU（ベータ）**に設定されている場合、TiFlash<sup>ベータ</sup>は使用できないことに注意してください。

### TiFlash<sup>ベータ</sup>ノードの数量 {#tiflash-sup-beta-sup-node-quantity}

TiDB Cloudは、TiFlash<sup>ベータ</sup>ノードをリージョン内のさまざまなアベイラビリティーゾーンに均等にデプロイします。実稼働環境で高可用性を実現するために、各TiDB Cloudクラスタに少なくとも2つのTiFlash<sup>ベータ</sup>ノードを構成し、データのレプリカを少なくとも2つ作成することをお勧めします。

TiFlash<sup>ベータ</sup>ノードの最小数は、特定のテーブルのTiFlash<sup>ベータ</sup>レプリカ数によって異なります。

TiFlash<sup>ベータ</sup>ノードの最小数： `min((compressed size of table A * replicas for table A + compressed size of table B * replicas for table B) / size of each TiFlash capacity, max(replicas for table A, replicas for table B))`

たとえば、AWSの各TiFlash<sup>ベータ</sup>ノードのストレージサイズを1024 GBに設定し、テーブルAに2つのレプリカ（圧縮サイズは800 GB）、テーブルBに1つのレプリカ（圧縮サイズは100 GB）を設定すると、その場合、必要なTiFlash<sup>ベータ</sup>ノードの数は次のとおりです。

TiFlash<sup>ベータ</sup>ノードの最小数： `min((800 GB * 2 + 100 GB * 1) / 1024 GB, max(2, 1)) ≈ 2`

### TiFlash<sup>ベータ</sup>ストレージサイズ {#tiflash-sup-beta-sup-storage-size}

クラスタを作成または復元する場合にのみ、TiFlash<sup>ベータ</sup>ストレージサイズを構成できます。

## パフォーマンスリファレンス {#performance-reference}

このセクションでは、5つの一般的なTiDBクラスタスケールの[TPC-C](https://www.tpc.org/tpcc/)および[Sysbench](https://github.com/akopytov/sysbench)のパフォーマンステスト結果を提供します。これらは、クラスタサイズを決定する際の参照として使用できます。

テスト環境：

-   TiDBバージョン：v5.4.0
-   倉庫：5000
-   データサイズ：366 G
-   テーブルサイズ：10000000
-   テーブル数：16

次のスケールのいずれかをクリックして、パフォーマンスデータを確認できます。

<details><summary>TiDB：4 vCPU * 2; TiKV：4 vCPU * 3</summary>

-   低遅延で最適なパフォーマンス

    TPC-Cのパフォーマンス：

    | トランザクションモデル | スレッド | tpmC   | QPS    | レイテンシー（ミリ秒） |
    | ----------- | ---- | ------ | ------ | ----------- |
    | TPCC        | 300  | 14,532 | 13,137 | 608         |

    Sysbench OLTPのパフォーマンス：

    | トランザクションモデル | スレッド | TPS    | QPS    | レイテンシー（ミリ秒） |
    | ----------- | ---- | ------ | ------ | ----------- |
    | 入れる         | 300  | 8,848  | 8,848  | 36          |
    | ポイントセレクト    | 600  | 46,224 | 46,224 | 13          |
    | 読み書き        | 150  | 719    | 14,385 | 209         |
    | インデックスの更新   | 150  | 4,346  | 4,346  | 35          |
    | 非インデックスを更新  | 600  | 13,603 | 13,603 | 44          |

-   最大TPSおよびQPS

    TPC-Cのパフォーマンス：

    | トランザクションモデル | スレッド  | tpmC   | QPS    | レイテンシー（ミリ秒） |
    | ----------- | ----- | ------ | ------ | ----------- |
    | TPCC        | 1,200 | 15,208 | 13,748 | 2,321       |

    Sysbench OLTPのパフォーマンス：

    | トランザクションモデル | スレッド  | TPS    | QPS    | レイテンシー（ミリ秒） |
    | ----------- | ----- | ------ | ------ | ----------- |
    | 入れる         | 1,500 | 11,601 | 11,601 | 129         |
    | ポイントセレクト    | 600   | 46,224 | 46,224 | 13          |
    | 読み書き        | 150   | 14,385 | 719    | 209         |
    | インデックスの更新   | 1,200 | 6,526  | 6,526  | 184         |
    | 非インデックスを更新  | 1,500 | 14,351 | 14,351 | 105         |

</details>

<details><summary>TiDB：8 vCPU * 2; TiKV：8 vCPU * 3</summary>

-   低遅延で最適なパフォーマンス

    TPC-Cのパフォーマンス：

    | トランザクションモデル | スレッド | tpmC   | QPS    | レイテンシー（ミリ秒） |
    | ----------- | ---- | ------ | ------ | ----------- |
    | TPCC        | 600  | 32,266 | 29,168 | 548         |

    Sysbench OLTPのパフォーマンス：

    | トランザクションモデル | スレッド  | TPS    | QPS    | レイテンシー（ミリ秒） |
    | ----------- | ----- | ------ | ------ | ----------- |
    | 入れる         | 600   | 17,831 | 17,831 | 34          |
    | ポイントセレクト    | 600   | 93,287 | 93,287 | 6           |
    | 読み書き        | 300   | 29,729 | 1,486  | 202         |
    | インデックスの更新   | 300   | 9,415  | 9,415  | 32          |
    | 非インデックスを更新  | 1,200 | 31,092 | 31,092 | 39          |

-   最大TPSおよびQPS

    TPC-Cのパフォーマンス：

    | トランザクションモデル | スレッド  | tpmC   | QPS    | レイテンシー（ミリ秒） |
    | ----------- | ----- | ------ | ------ | ----------- |
    | TPCC        | 1,200 | 33,394 | 30,188 | 1,048       |

    Sysbench OLTPのパフォーマンス：

    | トランザクションモデル | スレッド  | TPS    | QPS    | レイテンシー（ミリ秒） |
    | ----------- | ----- | ------ | ------ | ----------- |
    | 入れる         | 2,000 | 23,633 | 23,633 | 84          |
    | ポイントセレクト    | 600   | 93,287 | 93,287 | 6           |
    | 読み書き        | 600   | 30,464 | 1,523  | 394         |
    | インデックスの更新   | 2,000 | 15,146 | 15,146 | 132         |
    | 非インデックスを更新  | 2,000 | 34,505 | 34,505 | 58          |

</details>

<details><summary>TiDB：8 vCPU * 4; TiKV：8 vCPU * 6</summary>

-   低遅延で最適なパフォーマンス

    TPC-Cのパフォーマンス：

    | トランザクションモデル | スレッド  | tpmC   | QPS    | レイテンシー（ミリ秒） |
    | ----------- | ----- | ------ | ------ | ----------- |
    | TPCC        | 1,200 | 62,918 | 56,878 | 310         |

    Sysbench OLTPのパフォーマンス：

    | トランザクションモデル | スレッド  | TPS     | QPS     | レイテンシー（ミリ秒） |
    | ----------- | ----- | ------- | ------- | ----------- |
    | 入れる         | 1,200 | 33,892  | 33,892  | 23          |
    | ポイントセレクト    | 1,200 | 185,574 | 181,255 | 4           |
    | 読み書き        | 600   | 59,160  | 2,958   | 127         |
    | インデックスの更新   | 600   | 18,735  | 18,735  | 21          |
    | 非インデックスを更新  | 2,400 | 60,629  | 60,629  | 23          |

-   最大TPSおよびQPS

    TPC-Cのパフォーマンス：

    | トランザクションモデル | スレッド  | tpmC   | QPS    | レイテンシー（ミリ秒） |
    | ----------- | ----- | ------ | ------ | ----------- |
    | TPCC        | 2,400 | 65,452 | 59,169 | 570         |

    Sysbench OLTPのパフォーマンス：

    | トランザクションモデル | スレッド  | TPS     | QPS     | レイテンシー（ミリ秒） |
    | ----------- | ----- | ------- | ------- | ----------- |
    | 入れる         | 4,000 | 47,029  | 47,029  | 43          |
    | ポイントセレクト    | 1,200 | 185,574 | 181,255 | 4           |
    | 読み書き        | 1,200 | 60,624  | 3,030   | 197         |
    | インデックスの更新   | 4,000 | 30,140  | 30,140  | 67          |
    | 非インデックスを更新  | 4,000 | 68,664  | 68,664  | 29          |

</details>

<details><summary>TiDB：16 vCPU * 2; TiKV：16 vCPU * 3</summary>

-   低遅延で最適なパフォーマンス

    TPC-Cのパフォーマンス：

    | トランザクションモデル | スレッド  | tpmC   | QPS    | レイテンシー（ミリ秒） |
    | ----------- | ----- | ------ | ------ | ----------- |
    | TPCC        | 1,200 | 67,941 | 61,419 | 540         |

    Sysbench OLTPのパフォーマンス：

    | トランザクションモデル | スレッド  | TPS     | QPS     | レイテンシー（ミリ秒） |
    | ----------- | ----- | ------- | ------- | ----------- |
    | 入れる         | 1,200 | 35,096  | 35,096  | 34          |
    | ポイントセレクト    | 1,200 | 228,600 | 228,600 | 5           |
    | 読み書き        | 600   | 73,150  | 3,658   | 164         |
    | インデックスの更新   | 600   | 18,886  | 18,886  | 32          |
    | 非インデックスを更新  | 2,000 | 63,837  | 63,837  | 31          |

-   最大TPSおよびQPS

    TPC-Cのパフォーマンス：

    | トランザクションモデル | スレッド  | tpmC   | QPS    | レイテンシー（ミリ秒） |
    | ----------- | ----- | ------ | ------ | ----------- |
    | TPCC        | 1,200 | 67,941 | 61,419 | 540         |

    Sysbench OLTPのパフォーマンス：

    | トランザクションモデル | スレッド  | TPS     | QPS     | レイテンシー（ミリ秒） |
    | ----------- | ----- | ------- | ------- | ----------- |
    | 入れる         | 2,000 | 43,338  | 43,338  | 46          |
    | ポイントセレクト    | 1,200 | 228,600 | 228,600 | 5           |
    | 読み書き        | 1,200 | 73,631  | 3,682   | 326         |
    | インデックスの更新   | 3,000 | 29,576  | 29,576  | 101         |
    | 非インデックスを更新  | 3,000 | 64,624  | 64,624  | 46          |

</details>

<details><summary>TiDB：16 vCPU * 4; TiKV：16 vCPU * 6</summary>

-   低遅延で最適なパフォーマンス

    TPC-Cのパフォーマンス：

    | トランザクションモデル | スレッド  | tpmC    | QPS     | レイテンシー（ミリ秒） |
    | ----------- | ----- | ------- | ------- | ----------- |
    | TPCC        | 2,400 | 133,164 | 120,380 | 305         |

    Sysbench OLTPのパフォーマンス：

    | トランザクションモデル | スレッド  | TPS     | QPS     | レイテンシー（ミリ秒） |
    | ----------- | ----- | ------- | ------- | ----------- |
    | 入れる         | 2,400 | 69,139  | 69,139  | 22          |
    | ポイントセレクト    | 2,400 | 448,056 | 448,056 | 4           |
    | 読み書き        | 1,200 | 145,568 | 7,310   | 97          |
    | インデックスの更新   | 1,200 | 36,638  | 36,638  | 20          |
    | 非インデックスを更新  | 4,000 | 125,129 | 125,129 | 17          |

-   最大TPSおよびQPS

    TPC-Cのパフォーマンス：

    | トランザクションモデル | スレッド  | tpmC    | QPS     | レイテンシー（ミリ秒） |
    | ----------- | ----- | ------- | ------- | ----------- |
    | TPCC        | 2,400 | 133,164 | 120,380 | 305         |

    Sysbench OLTPのパフォーマンス：

    | トランザクションモデル | スレッド  | TPS     | QPS     | レイテンシー（ミリ秒） |
    | ----------- | ----- | ------- | ------- | ----------- |
    | 入れる         | 4,000 | 86,242  | 86,242  | 25          |
    | ポイントセレクト    | 2,400 | 448,056 | 448,056 | 4           |
    | 読み書き        | 2,400 | 146,526 | 7,326   | 172         |
    | インデックスの更新   | 6,000 | 58,856  | 58,856  | 51          |
    | 非インデックスを更新  | 6,000 | 128,601 | 128,601 | 24          |

</details>
