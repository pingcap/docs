---
title: 配置维护时间窗
summary: 了解如何为你的集群配置维护时间窗。
---

# 配置维护时间窗

维护时间窗是指在指定的时间段内，自动执行计划内的维护任务，如操作系统更新、安全补丁和基础设施升级，以确保 TiDB Cloud service 的可靠性、安全性和性能。

在维护时间窗期间，维护会在 TiDB Cloud Dedicated 集群上逐个执行，因此整体影响最小。虽然可能会出现临时的连接中断或 QPS 波动，但集群始终可用，现有的数据导入、备份、恢复、迁移和复制任务仍可正常运行。

通过配置维护时间窗，你可以轻松地安排和管理维护任务，以最小化维护影响。例如，你可以设置维护时间窗的开始时间，避开应用负载的高峰时段。

> **注意：**
>
> 维护时间窗功能仅适用于 [TiDB Cloud Dedicated 集群](/tidb-cloud/select-cluster-tier.md#tidb-cloud-dedicated)。

## 维护时间窗期间允许和不允许的操作

在维护时间窗期间，部分操作是允许的，部分操作则不允许。

- 允许的操作：

    - SQL 操作
    - 创建集群
    - 删除集群
    - 创建备份任务
    - 恢复集群
    - 访问集群页面

- 不允许的操作：

    - 修改、暂停或恢复集群
    - 在 TiDB Cloud 控制台中更改安全设置
    - 创建私有链接或配置 VPC 对等连接
    - 创建导入任务、迁移作业或 changefeed
    - 扩缩迁移作业或 changefeed 的规格

## 获取维护时间窗通知

为避免潜在的中断，了解维护计划并据此安排你的操作非常重要。

每个维护时间窗，TiDB Cloud 会在以下时间点向所有项目成员发送四封邮件通知：

- 维护时间窗开始前两周（不包括紧急维护任务）
- 维护时间窗开始前 72 小时
- 维护时间窗开始时
- 维护时间窗完成时

## 查看和配置维护时间窗

定期维护可确保执行重要更新，保护 TiDB Cloud 免受安全威胁、性能问题和不可靠性的影响。因此，维护时间窗默认启用且无法禁用。

> **注意：**
>
> - 对于首次注册 TiDB Cloud 时自动创建的默认项目，维护时间窗将在每周三凌晨 03:00（基于你的 TiDB Cloud 组织的时区）开始。
> - 对于你新创建的项目，可以在项目设置期间自定义维护时间窗的开始时间。

你可以按如下方式将开始时间修改为你偏好的时间，或在截止时间前重新调度维护任务：

1. 在 [TiDB Cloud 控制台](https://tidbcloud.com)中，使用左上角的下拉框切换到目标项目。
2. 在左侧导航栏，点击 **Project Settings** > **Maintenance**。
3. 在 **Maintenance** 页面，查看维护信息。

     - 如果有维护任务显示，请查看描述、计划开始时间和截止时间。维护任务将在指定时间开始。

     - 如果没有维护数据，表示近期没有计划的维护任务。

4. （可选）点击 **Maintenance Window Setting** 修改维护时间窗的开始时间。请注意，只有当本周有计划的维护任务时，维护才会在指定的开始时间执行。

5. 若需重新调度某个具体的维护任务，在 **Action** 列点击 **...** > **Reschedule**，并在截止时间前选择新的时间。

    如果你需要将维护任务重新调度到截止时间之后，请联系 [TiDB Cloud Support](/tidb-cloud/tidb-cloud-support.md) 获取帮助。

## 常见问题

- 什么是维护任务？

    维护任务通常包括操作系统更新、安全补丁和基础设施升级。

- 我可以禁用维护时间窗吗？

    不可以。维护时间窗默认启用且无法禁用。你可以修改维护时间窗的开始时间，或在截止时间前重新调度维护任务。详情请参见 [查看和配置维护时间窗](#view-and-configure-maintenance-windows)。

- 维护时间窗持续多长时间？

    视情况而定。对于每个项目，维护会在符合条件的 TiDB 集群上逐个执行。维护的持续时间取决于集群数量、集群数据量以及需要执行的维护任务。

- 维护任务会在任意状态的集群上执行吗？

    不会。TiDB Cloud 会在对集群执行维护任务前检查集群状态。

    - 如果集群处于 **Creating** 或 **Paused** 状态，则无需执行维护任务。
    - 如果集群正在执行自动或手动备份，维护将被延迟，直到当前备份成功完成后才会触发。请注意，对于数据量较大的集群，备份过程可能需要较长时间，例如 12 小时。为尽量减少对集群的影响，建议合理设置备份和维护时间窗的开始时间。
    - 如果集群处于其他任何状态，维护任务将按计划开始。