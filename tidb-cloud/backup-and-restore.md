---
title: Back Up and Restore TiDB Dedicated Data
summary: Learn how to back up and restore your TiDB Dedicated cluster.
aliases: ['/tidbcloud/restore-deleted-tidb-cluster']
---

# TiDB 専用データのバックアップと復元 {#back-up-and-restore-tidb-dedicated-data}

このドキュメントでは、 TiDB Cloud上で TiDB 専用クラスター データをバックアップおよび復元する方法について説明します。

> **ヒント：**
>
> TiDB サーバーレス クラスター データをバックアップおよび復元する方法については、 [TiDB サーバーレス データのバックアップと復元](/tidb-cloud/backup-and-restore-serverless.md)を参照してください。

## 制限事項 {#limitations}

-   TiDB Cloudは、ユーザー権限やシステム変数を含む`mysql`スキーマ内のテーブルの復元をサポートしていません。
-   PITR (ポイントインタイムリカバリ) を複数回オン/オフにした場合、最新の PITR が有効になった後の回復可能な範囲内の時点のみを選択できます。以前の回復可能範囲にはアクセスできません。

## バックアップ {#backup}

TiDB D dedicated は自動バックアップと手動バックアップをサポートしています。

バックアップ設定に従って TiDB 専用クラスターの自動バックアップがスケジュールされるため、極端な災害状況での損失を軽減できます。また、いつでもバックアップ スナップショットを選択して、新しい TiDB 専用クラスターに復元することもできます。

### 自動バックアップ {#automatic-backup}

自動バックアップにより、毎日設定したバックアップ時刻に TiDB D dedicated クラスターのデータをバックアップできます。バックアップ時間を設定するには、次の手順を実行します。

1.  TiDB 専用クラスターの**バックアップ**ページに移動します。

2.  **[バックアップ設定]**をクリックします。設定ウィンドウが表示されます。

3.  設定ウィンドウで、自動バックアップを構成します。

    -   **[自動バックアップ]**スイッチを**[オン]**に切り替えます。

    -   **[バックアップ サイクル]**で、 **[毎日]**または**[毎週]**チェックボックスを選択します。 **[毎週]**を選択した場合は、バックアップを行う曜日を指定する必要があります。

    -   **[バックアップ時間]**で、日次または週次のクラスター バックアップの開始時刻をスケジュールします。

        ワークロードが低い期間に自動バックアップをスケジュールすることをお勧めします。優先バックアップ時刻を指定しない場合、 TiDB Cloudはデフォルトのバックアップ時刻を割り当てます。これは、クラスターが配置されているリージョンのタイムゾーンの午前 2 時です。

    -   **[バックアップの保持期間]**で、バックアップ データの最小保持期間を構成します。

    -   PITR (**ポイントインタイムリカバリ**) 機能をオンまたはオフにします。

        > **注記：**
        >
        > -   PITR 機能はデフォルトで有効になっており、毎週のバックアップを有効にした場合は無効にすることはできません。
        > -   バックアップ サイクルを毎週から毎日に変更しても、PITR 機能は有効なままになります。必要に応じて手動で無効にすることができます。

        PITR は、任意の時点のデータを新しいクラスターに復元することをサポートします。これを使用して次のことができます。

        -   災害復旧における RPO を削減します。
        -   エラー イベントの前の時点を復元することで、データ書き込みエラーのケースを解決します。
        -   ビジネスの履歴データを監査します。

        上記のいずれかのニーズがあり、PITR 機能を使用したい場合は、TiDB 専用クラスターのバージョンが v6.4.0 以上であり、TiKV ノードが少なくとも 8 vCPU および 16 GiB であることを確認してください。

    -   **[バックアップ ストレージリージョン]**で、バックアップ データを保存するリージョンを選択します。

        TiDB Cloudは、デフォルトでバックアップ データをクラスターの現在のリージョンに保存します。この動作は変更できません。さらに、別のリモート リージョンを追加すると、 TiDB Cloudがすべての新しいバックアップ データをリモート リージョンにコピーするため、データの安全性と迅速なリカバリが容易になります。リモート リージョンをバックアップ データstorageとして追加した後は、そのリージョンを削除できません。

4.  **「確認」**をクリックして構成変更をプレビューします。

    PITR をオンにすると、 **[バックアップをすぐに実行する] を選択し、それを PITR のリカバリ開始点として使用できます。**チェックボックス。そうしないと、次のバックアップが完了するまで PITR を使用できなくなります。

5.  **「確認」**をクリックします。

### バックアップstorage領域のサポート {#backup-storage-region-support}

現在、バックアップ データstorageとして任意のリモート リージョンを選択することはできません。すでにサポートされている地域は次のとおりです。

| クラウドプロバイダー | クラスタ領域      | 遠隔地サポート    |
| ---------- | ----------- | ---------- |
| グーグルクラウド   | 東京 (アジア北東1) | 大阪（アジア東北2） |

> **注記：**
>
> 複数のバックアップstorageリージョンを選択した場合、複数のバックアップstorageと、クラスター リージョンから各宛先リージョンへのリージョン間のバックアップ データ レプリケーションに対して料金が発生します。コストはリージョンごとに異なり、選択したバックアップ リージョンによって異なります。詳細については、 [データバックアップコスト](https://www.pingcap.com/tidb-cloud-pricing-details/#backup-storage-cost)を参照してください。

### 手動バックアップ {#manual-backup}

手動バックアップはユーザーが開始するバックアップで、必要に応じてデータを既知の状態にバックアップし、いつでもその状態に復元できます。

TiDB 専用クラスターに手動バックアップを適用するには、次の手順を実行します。

1.  クラスターの**「バックアップ」**タブに移動します。

2.  **[手動バックアップ]**をクリックします。設定ウィンドウが表示されます。

3.  **名前**を入力します。

4.  **「確認」**をクリックします。その後、クラスター データがバックアップされます。

### バックアップファイルを削除する {#delete-backup-files}

既存のバックアップ ファイルを削除するには、次の手順を実行します。

1.  クラスターの**「バックアップ」**タブに移動します。

2.  削除するバックアップ ファイルの**[削除]**をクリックします。

### 実行中のバックアップ ジョブを削除する {#delete-a-running-backup-job}

実行中のバックアップ ジョブを削除するには、 [**バックアップファイルを削除する**](#delete-backup-files)と同様です。

1.  クラスターの**「バックアップ」**タブに移動します。

2.  **保留**中または**実行中**状態のバックアップ ファイルの**[削除]**をクリックします。

### バックアップのベストプラクティス {#best-practices-for-backup}

-   ビジネスへの影響を最小限に抑えるために、クラスターのアイドル時にバックアップ操作を実行することをお勧めします。
-   データのインポート中またはクラスターのスケーリング中に手動バックアップを実行しないでください。
-   クラスターを削除した後、既存の手動バックアップ ファイルは、手動で削除するかアカウントが閉鎖されるまで保持されます。自動バックアップ ファイルは、クラスターの削除日から指定した期間保存されます (保存期間は**[バックアップ設定]**で構成できます)。必要に応じてバックアップ ファイルを削除する必要があります。

## 復元する {#restore}

TiDB D dedicated は、次の 2 種類のデータ復元を提供します。

-   バックアップ データを新しいクラスターに復元する
-   削除されたクラスターをごみ箱から復元する

### データを新しいクラスターに復元する {#restore-data-to-a-new-cluster}

TiDB 専用クラスター データをバックアップから新しいクラスターに復元するには、次の手順を実行します。

1.  クラスターの**「バックアップ」**タブに移動します。

2.  **「復元」**をクリックします。設定ウィンドウが表示されます。

3.  **復元モード**では、任意の時点のデータまたは選択したバックアップを新しいクラスターに復元することを選択できます。

    <SimpleTab>
     <div label="Select Time Point">

    バックアップ保持期間内の任意の時点のデータを新しいクラスターに復元するには、**バックアップ設定**の**PITR が**オンになっていることを確認してから、次の手順を実行します。

    1.  **[時点の選択]**をクリックします。
    2.  復元したい**日付**と**時刻**を選択します。

    </div>

    <div label="Select Backup Name">

    選択したバックアップを新しいクラスターに復元するには、次の手順を実行します。

    1.  **[バックアップ名の選択]**をクリックします。
    2.  復元先のバックアップを選択します。

    </div>
     </SimpleTab>

4.  **[リージョンに復元]**で、**バックアップ設定**で構成された**バックアップ ストレージリージョン**と同じリージョンを選択します。

5.  **[復元]**ウィンドウでは、必要に応じて次の変更を行うこともできます。

    -   クラスター名を設定します。
    -   クラスターのポート番号を更新します。
    -   クラスターのノード数、vCPU と RAM、storageを増やします。

6.  **「復元」**をクリックします。

    クラスターの復元プロセスが開始され、 **[Security設定]**ダイアログ ボックスが表示されます。

7.  **[Security設定]**ダイアログ ボックスで、root パスワードとクラスターへの接続を許可する IP アドレスを設定し、 **[適用]**をクリックします。

### 削除されたクラスターを復元する {#restore-a-deleted-cluster}

削除されたクラスターをごみ箱から復元するには、次の手順を実行します。

1.  [TiDB Cloudコンソール](https://tidbcloud.com)にログインします。

2.  クリック<mdsvgicon name="icon-left-projects">複数のプロジェクトがある場合は、左下隅でターゲット プロジェクトに切り替え、 **[プロジェクト設定]**をクリックします。</mdsvgicon>

3.  プロジェクトの [**プロジェクト設定]**ページで、左側のナビゲーション ペインで**[ごみ箱]**をクリックし、復元するクラスターを見つけて、 **[操作]**列の**[バックアップ]**をクリックします。

4.  希望のバックアップ時刻を見つけて、 **[アクション]**列の**[復元]**をクリックします。

5.  **[復元]**ウィンドウで、必要に応じて次の変更を加えます。

    -   クラスターのポート番号を更新します。
    -   クラスターのノード数、vCPU、RAM、storageを増やします。

6.  **「確認」**をクリックします。

    クラスターの復元プロセスが開始され、 **[Security設定]**ダイアログ ボックスが表示されます。

7.  **[Security設定]**ダイアログ ボックスで、root パスワードとクラスターへの接続を許可する IP アドレスを設定し、 **[適用]**をクリックします。

> **注記：**
>
> 削除されたクラスターを任意の時点に復元することはできません。復元するには自動または手動バックアップのみを選択できます。
