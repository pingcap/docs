---
title: "TiDB Cloud Premium Built-in Metrics"
summary: TiDB Cloud Premium の組み込みメトリックを表示する方法と、これらのメトリックの意味を理解する方法について説明します。
---

# TiDB Cloud Premium 組み込みメトリクス {#tidb-cloud-premium-built-in-metrics}

TiDB Cloudは、クラスターの標準メトリクスを一通り収集し、「メトリクス」ページに表示します。これらのメトリクスを表示することで、パフォーマンスの問題を簡単に特定し、現在のデータベース環境が要件を満たしているかどうかを判断できます。

## メトリクスページをビュー {#view-the-metrics-page}

**「メトリクス」**ページでメトリクスを表示するには、次の手順を実行します。

1.  [**TiDBインスタンス**](https://tidbcloud.com/tidbs)ページで、ターゲットインスタンスの名前をクリックして、概要ページに移動します。

    > **ヒント：**
    >
    > 左上隅のコンボ ボックスを使用して、組織と TiDB インスタンスを切り替えることができます。

2.  左側のナビゲーション ペインで、 **[監視]** &gt; **[メトリック]**をクリックします。

## メトリクス保持ポリシー {#metrics-retention-policy}

TiDB Cloudインスタンスの場合、メトリック データは 7 日間保持されます。

## TiDB Cloud Premium インスタンスのメトリクス {#metrics-for-tidb-cloud-premium-instances}

次のセクションでは、TiDB Cloud Premium インスタンスの**[メトリック]**ページのメトリックについて説明します。

### 概要 {#overview}

| メトリック名              | ラベル                                 | 説明                                                                                                                                                           |
| :------------------ | :---------------------------------- | :----------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 1秒あたりのリクエストユニット     | 1秒あたりの合計RU                          | リクエストユニット（RU）は、クエリまたはトランザクションのリソース消費量を追跡するために使用される測定単位です。リクエストユニットは、実行したクエリだけでなく、バックグラウンドアクティビティによっても消費される可能性があるため、QPSが0の場合でも、1秒あたりのリクエストユニット数は0ではない場合があります。 |
| 使用済みストレージサイズ        | {タイプ}                               | 行ストアのサイズと列ストアのサイズ。                                                                                                                                           |
| 1秒あたりのクエリ数          | すべて、{SQL タイプ}                       | すべての TiDB インスタンスで 1 秒あたりに実行された SQL ステートメントの数`SELECT` `UPDATE`の SQL タイプ`INSERT`に収集されます。                                                                       |
| クエリ期間               | 平均、平均-{SQL タイプ}、99、99-{SQL タイプ}     | クライアントから TiDB へのリクエストを受信してから、TiDB がリクエストを実行し、結果をクライアントに返すまでの期間。                                                                                              |
| SQLタイプ別のデータベース時間    | すべて、{SQL タイプ}                       | すべて: 1 秒あたりの合計データベース時間。<br/> `UPDATE` SQL タイプ}: 1 秒あたりに SQL ステートメントによって消費されたデータベース時間`SELECT`などの SQL タイプ`INSERT`に収集されます。                                      |
| 失敗したクエリ             | 全て                                  | 1 分あたりの SQL ステートメント実行エラーに応じたエラー タイプ (構文エラーや主キーの競合など) の統計。                                                                                                    |
| 1秒あたりのコマンド数         | {タイプ}                               | コマンドの種類に基づいて、すべての TiDB インスタンスによって 1 秒あたりに処理されるコマンドの数。                                                                                                        |
| プランキャッシュOPSを使用したクエリ | ヒット、ミス                              | ヒット: すべての TiDB インスタンスで 1 秒あたりにプラン キャッシュを使用するクエリの数。<br/>ミス: すべての TiDB インスタンスで 1 秒あたりにプラン キャッシュが欠落しているクエリの数。                                                   |
| 1秒あたりのトランザクション      | {タイプ}-{トランザクション モデル}                | 1 秒あたりに実行されるトランザクションの数。                                                                                                                                      |
| トランザクション期間          | 平均-{トランザクション モデル}、99-{トランザクション モデル} | トランザクションの平均期間または 99 パーセンタイル期間。                                                                                                                               |
| 接続数                 | すべて、アクティブな接続                        | すべて: すべての TiDB インスタンスへの接続数。<br/>アクティブ接続: すべての TiDB インスタンスへのアクティブな接続の数。                                                                                       |
| 切断回数                | {結果}                                | すべての TiDB インスタンスから切断されたクライアントの数。                                                                                                                             |

### データベース {#database}

| メトリック名        | ラベル                             | 説明                                                                                     |
| :------------ | :------------------------------ | :------------------------------------------------------------------------------------- |
| DBあたりのQPS     | すべて、{データベース}                    | 各データベースで 1 秒あたりに実行された SQL ステートメントの数。1 、 `SELECT` `INSERT` `UPDATE`などの SQL タイプ別に収集されます。 |
| DBあたりのクエリ実行時間 | avg、avg-{データベース}、99、99-{データベース} | クライアントからデータベースへのリクエストを受信してから、データベースがリクエストを実行し、結果をクライアントに返すまでの期間。                       |
| DBごとの失敗したクエリ  | すべて、{データベース}                    | 各データベースにおける 1 秒あたりの SQL ステートメント実行エラーに応じたエラー タイプの統計。                                    |

### 高度な {#advanced}

| メトリック名                    | ラベル                     | 説明                                                                                                                                           |
| :------------------------ | :---------------------- | :------------------------------------------------------------------------------------------------------------------------------------------- |
| 平均アイドル接続時間                | 平均トランザクション内、平均トランザクション外 | 接続アイドル期間は、接続がアイドル状態にある期間を示します。<br/> avg-in-txn: 接続がトランザクション内にあるときの平均接続アイドル期間。<br/> avg-not-in-txn: 接続がトランザクション内にない場合の平均接続アイドル期間。             |
| トークンの有効期限を取得する            | 平均、99                   | SQL ステートメントのトークンを取得するのに費やされた平均または 99 パーセンタイル期間。                                                                                              |
| 解析期間                      | 平均、99                   | SQL ステートメントの解析に費やされた平均または 99 パーセンタイル期間。                                                                                                      |
| コンパイル時間                   | 平均、99                   | 解析された SQL AST を実行プランにコンパイルするのに要した平均時間または 99 パーセンタイル時間。                                                                                       |
| 実行時間                      | 平均、99                   | SQL ステートメントの実行プランの実行に費やされた平均または 99 パーセンタイル期間。                                                                                                |
| 平均 TiDB KV リクエスト期間        | {リクエストタイプ}              | `Get` 、 `Prewrite` 、 `Commit`などのリクエスト タイプに基づいて、すべての TiDB インスタンスで KV リクエストの実行に費やされた平均時間。                                                      |
| 平均 / P99 PD TSO 待機/RPC 期間 | 待機平均/99、rpc平均/99        | 待機: すべての TiDB インスタンスで PD が TSO を返すのを待機する平均期間または 99 パーセンタイル期間。<br/> RPC: すべての TiDB インスタンスで TSO 要求を PD に送信してから TSO を受信するまでの平均時間または 99 パーセンタイル。 |

## FAQ {#faq}

**1. このページの一部のペインが空になっているのはなぜですか?**

ペインにメトリックが表示されない場合は、次のような理由が考えられます。

-   対応するクラスターのワークロードは、このメトリックをトリガーしません。たとえば、失敗したクエリがない場合、失敗したクエリのメトリックは常に空になります。
-   クラスターのバージョンが低いです。これらのメトリクスを表示するには、TiDB の最新バージョンにアップグレードする必要があります。

これらすべての理由が除外される場合は、トラブルシューティングのために[PingCAPサポートチーム](/tidb-cloud/tidb-cloud-support.md)に問い合わせることができます。

**2. まれにメトリックが不連続になることがあるのはなぜですか?**

まれに、メトリクス システムに高い負荷がかかった場合など、メトリクスが失われる場合があります。

この問題が発生した場合は、トラブルシューティングのために[PingCAP サポート](/tidb-cloud/tidb-cloud-support.md)お問い合わせください。
