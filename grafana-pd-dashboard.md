---
title: Key Monitoring Metrics of PD
summary: Grafana PD ダッシュボードに表示されるいくつかの主要なメトリックについて学習します。
---

# PDの主要なモニタリング指標 {#key-monitoring-metrics-of-pd}

TiUPを使用してTiDBクラスターをデプロイする場合、監視システム（PrometheusとGrafana）も同時にデプロイされます。詳細については、 [監視フレームワークの概要](/tidb-monitoring-framework.md)参照してください。

Grafanaダッシュボードは、Overview、PD、TiDB、TiKV、Node_exporter、Disk Performance、Performance_overviewといった一連のサブダッシュボードに分かれています。診断に役立つ多くの指標が用意されています。

PDダッシュボードでは、コンポーネントのPDステータスの概要と主要な指標を確認できます。このドキュメントでは、これらの主要な指標について詳しく説明します。

PD ダッシュボード メトリック項目の説明は次のとおりです。

-   PDロール: 現在のPDインスタンスのロール
-   ストレージ容量: この TiDB クラスターの合計storage容量
-   現在のstorageサイズ: TiDB クラスターで現在使用されているstorageサイズ
-   現在のstorage使用量: 現在のstorage使用率
-   通常のストア: 正常なstorageインスタンスの数
-   リージョン数: クラスターリージョンの総数
-   異常なストア: 不健全なストアの数。正常値は`0`です。この数値が`0`より大きい場合、少なくとも 1 つのインスタンスが異常であることを意味します。
-   リージョンの健全性: 保留中のピア、ダウン中のピア、余分なピア、オフラインのピア、欠落しているピア、学習中のピア、不正な名前空間など、異常なリージョンの数でリージョンの健全性を示します。通常、保留中のピアの数は`100`未満である必要があります。欠落しているピアの数は`0`を超えてはなりません。空のリージョンが多数存在する場合は、リージョンマージを適時に有効化してください。
-   現在のピア数: すべてのクラスタピアの現在の数![PD Dashboard - Header](/media/pd-dashboard-header-v4.png)

## 主要な指標の説明 {#key-metrics-description}

## クラスタ {#cluster}

-   PDスケジューラ設定: PDスケジューラ設定のリスト
-   クラスタID: クラスターの一意の識別子
-   現在のTSO: 現在割り当てられているTSOの物理部分
-   現在のID割り当て: 新しいストア/ピアに割り当てられる最大ID
-   リージョンラベル分離レベル: 異なるラベルレベルの地域数
-   ラベルの配布: クラスタ内のラベルの配布状態
-   ストア制限: ストアでのスケジュールのフロー制御制限

![PD Dashboard - Cluster metrics](/media/pd-dashboard-cluster-v4.png)

## オペレーター {#operator}

-   オペレータ作成のスケジュール: タイプごとに新しく作成されるオペレータの数
-   スケジュール演算子チェック: 種類ごとにチェックされる演算子の数。主に現在のステップが完了したかどうかをチェックし、完了している場合は次に実行するステップを返します。
-   スケジュールオペレータ終了: タイプごとに終了したオペレータの数
-   スケジュールオペレータのタイムアウト: タイプごとのタイムアウトオペレータの数
-   スケジュールオペレータの交代またはキャンセル: タイプごとに交代またはキャンセルされたオペレータの数
-   州別の運行管理者数: 州ごとの運行管理者数
-   オペレータ終了時間: 終了したオペレータの最大時間
-   オペレータステップの所要時間: 完了したオペレータステップの最大所要時間

![PD Dashboard - Operator metrics](/media/pd-dashboard-operator-v4.png)

## 統計- バランス {#statistics-balance}

-   ストア容量: TiKVインスタンスあたりの容量サイズ
-   利用可能なストア: TiKVインスタンスあたりの利用可能な容量サイズ
-   使用済みストア: TiKVインスタンスごとの使用済み容量サイズ
-   サイズ増幅: TiKVインスタンスあたりのサイズ増幅率。これは、(ストアリージョンサイズ)/(ストア使用容量サイズ)に等しい。
-   利用可能なサイズ比率: TiKVインスタンスあたりの利用可能なサイズ比率。これは、(ストアの利用可能な容量サイズ)/(ストアの容量サイズ)に等しくなります。
-   ストアリーダースコア: TiKVインスタンスごとのリーダースコア
-   ストアリージョンスコア: TiKVインスタンスごとのリージョンリージョン
-   ストアリーダーサイズ: TiKVインスタンスあたりのリーダーサイズの合計
-   ストアリージョンサイズ: TiKVインスタンスあたりのリージョンサイズの合計
-   ストアリーダー数: TiKVインスタンスあたりのリーダー数
-   ストアリージョン数: TiKVインスタンスあたりのリージョン数

![PD Dashboard - Balance metrics](/media/pd-dashboard-balance-v4.png)

## 統計- ホットライト {#statistics-hot-write}

-   ホットリージョンのリーダー分布: 各 TiKV インスタンスで書き込みホットスポットとなったリーダーリージョンの合計数
-   ホットリーダー領域の合計書き込みバイト数: 各 TiKV インスタンスで書き込みホットスポットとなったリーダー領域による合計書き込みバイト数
-   ホットライトリージョンのピア分布: 各 TiKV インスタンスで書き込みホットスポットとなったピアリージョンの合計数
-   ホットピア領域の合計書き込みバイト数: 各 TiKV インスタンスで書き込みホットスポットとなったすべてのピア領域の書き込みバイト数
-   ストア書き込みレートバイト: 各 TiKV インスタンスに書き込まれた合計バイト数
-   ストア書き込みレートキー: 各 TiKV インスタンスに書き込まれたキーの合計
-   ホットキャッシュ書き込みエントリ数: 書き込みホットスポット統計モジュールにある各 TiKV インスタンス上のピアの数
-   セレクタイベント: ホットスポットスケジューリングモジュールのセレクタのイベント数
-   ホットスポット移動リーダーの方向: ホットスポットスケジューリングにおけるリーダーの移動方向。正の数値はインスタンスへのスケジューリングを意味し、負の数値はインスタンスからのスケジューリングを意味します。
-   ホットスポット移動ピアの方向: ホットスポットスケジューリングにおけるピアの移動方向。正の数値はインスタンスへのスケジューリングを意味し、負の数値はインスタンスからのスケジューリングを意味します。

![PD Dashboard - Hot write metrics](/media/pd-dashboard-hotwrite-v4.png)

## 統計- ホットリード {#statistics-hot-read}

-   ホットリージョンのピア分布: 各 TiKV インスタンスで読み取りホットスポットとなったピアリージョンの合計数
-   ホットピアリージョンの合計読み取りバイト数: 各 TiKV インスタンスで読み取りホットスポットとなったピアの合計読み取りバイト数
-   ストア読み取りレートバイト: 各 TiKV インスタンスの合計読み取りバイト数
-   ストア読み取りレートキー: 各 TiKV インスタンスの合計読み取りキー
-   ホットキャッシュ読み取りエントリ数: 各 TiKV インスタンスの読み取りホットスポット統計モジュールにあるピアの数

![PD Dashboard - Hot read metrics](/media/pd-dashboard-hotread-v4.png)

## スケジューラ {#scheduler}

-   スケジューラは実行中です: 現在実行中のスケジューラ
-   バランスリーダーの動き: TiKVインスタンス間のリーダーの動きの詳細
-   バランスリージョンの移動: TiKVインスタンス間のリージョン移動の詳細
-   バランスリーダーイベント:バランスリーダーイベントの数
-   バランスリージョンイベント: バランスリージョンイベントの数
-   バランスリーダースケジューラ: バランスリーダースケジューラの内部状態
-   バランスリージョンスケジューラ: バランスリージョンスケジューラの内部状態
-   レプリカチェッカー:レプリカチェッカーのステータス
-   ルールチェッカー: ルールチェッカーのステータス
-   リージョンマージチェッカー: マージチェッカーのステータス
-   フィルターターゲット: 店舗がスケジュールターゲットとして選択されたが、フィルターを通過できなかった試行回数
-   フィルターソース: 店舗がスケジュールソースとして選択されたが、フィルターを通過できなかった試行回数
-   バランス方向: 店舗がスケジュールの対象またはソースとして選択された回数

![PD Dashboard - Scheduler metrics](/media/pd-dashboard-scheduler-v4.png)

## gRPC {#grpc}

-   完了コマンド率: gRPC コマンドが完了するコマンド タイプごとの率
-   99% 完了コマンド期間: gRPC コマンドが完了するコマンド タイプごとの割合 (P99)

![PD Dashboard - gRPC metrics](/media/pd-dashboard-grpc-v2.png)

## など {#etcd}

-   処理トランザクション数: etcdがトランザクションを処理する速度
-   99% 取引処理時間: 取引処理率 (P99)
-   99% WAL fsync 実行時間: WAL を永続storageに書き込むのにかかる時間`1s` (P99) 未満です。
-   99% ピアラウンドトリップタイム（秒）: etcd のネットワークレイテンシー（P99）| 値は`1s`未満です
-   etcd ディスク WAL fsync レート: 永続storageへの WAL の書き込みレート
-   Raftの用語: Raftの現在の用語
-   Raftコミットインデックス: Raftの最後にコミットされたインデックス
-   Raft適用インデックス: Raftの最後に適用されたインデックス

![PD Dashboard - etcd metrics](/media/pd-dashboard-etcd-v2.png)

## TiDB {#tidb}

-   PDサーバTSO処理時間とクライアント受信時間: PDがTSO要求を受信してからPDクライアントがTSO応答を受信するまでの時間
-   処理要求数: TiDB 要求の数
-   リクエスト処理時間: TiDBリクエストの処理に要した時間。1 (P99) `100ms`である必要があります。

![PD Dashboard - TiDB metrics](/media/pd-dashboard-tidb-v4.png)

## ハートビート {#heartbeat}

-   ハートビート領域イベントQPS: キャッシュの更新やデータの永続化を含むハートビートメッセージの処理のQPS
-   リージョンハートビートレポート: インスタンスごとにPDに報告されたハートビートの数
-   リージョンハートビートレポートエラー: ステータスが`error`のハートビートの数
-   リージョンハートビートレポートがアクティブ: ステータスが`ok`ハートビートの数
-   リージョンスケジュールプッシュ: TiKVインスタンスごとにPDから送信された対応するスケジュールコマンドの数
-   99%リージョンハートビートレイテンシー: TiKVインスタンスあたりのハートビートレイテンシー(P99)

![PD Dashboard - Heartbeat metrics](/media/pd-dashboard-heartbeat-v4.png)

## リージョンstorage {#region-storage}

-   シンカーインデックス: リーダーによって記録されたリージョン変更履歴の最大インデックス
-   履歴最終インデックス:リージョン変更履歴がフォロワーと正常に同期された最後のインデックス

![PD Dashboard - Region storage](/media/pd-dashboard-region-storage.png)
