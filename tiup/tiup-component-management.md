---
title: Manage TiUP Components with TiUP Commands
summary: TiUPコマンドを使用してTiUPコンポーネントを管理する方法を学習します。
---

# TiUPTiUPを管理する {#manage-tiup-components-with-tiup-commands}

次のTiUPコマンドを使用して、 TiUPエコシステム内のコンポーネントを管理できます。

-   list:コンポーネントリストを照会します。このTiUPコマンドを使用すると、インストールするすべてのオプション コンポーネントと、各コンポーネントのすべてのオプション バージョンを確認できます。
-   install:コンポーネントの特定のバージョンをインストールします。
-   update:コンポーネントを最新バージョンに更新します。
-   uninstall:コンポーネントをアンインストールします。
-   status: 実行中のコンポーネントのステータスを確認します。
-   clean:コンポーネントがデプロイされているインスタンスをクリーンアップします。
-   help: ヘルプ情報を出力します。このコマンドに別のTiUPコマンドを追加すると、追加されたコマンドの使用方法が出力されます。
-   link:コンポーネントのバイナリを実行可能ディレクトリ（ `$TIUP_HOME/bin/` ）にリンクします。
-   unlink: `tiup link`コマンドによって生成されたソフト リンクを削除します。

このドキュメントでは、一般的なコンポーネント管理操作と対応するTiUPコマンドについて説明します。

## コンポーネントリストを照会する {#query-the-component-list}

`tiup list`コマンドを使用してコンポーネントリストを照会できます。このコマンドの使用方法は次のとおりです。

-   `tiup list` : インストールできるコンポーネントを確認します。
-   `tiup list ${component}` : 特定のコンポーネントのどのバージョンをインストールできるかを確認します。

上記のコマンドでは次のフラグを使用することもできます。

-   `--installed` : どのコンポーネントまたは特定のコンポーネントのどのバージョンがローカルにインストールされているかを確認します。 - `--all` : 非表示のコンポーネントも含め、すべてのコンポーネントを表示します - `--verbose` : すべての列を表示します (インストールされているバージョンとサポートされているプラ​​ットフォームを含む)

例 1: 現在インストールされているすべてのコンポーネントをビュー。

```shell
tiup list --installed
```

例 2:サーバーからインストール可能なすべてのバージョンの TiKVコンポーネントのリストを取得します。

```shell
tiup list tikv
```

## コンポーネントをインストールする {#install-components}

`tiup install`コマンドを使用してコンポーネントリストを照会できます。このコマンドの使用方法は次のとおりです。

-   `tiup install <component>` : 指定されたコンポーネントの最新の安定バージョンをインストールします。
-   `tiup install <component>:[version]` : 指定されたコンポーネントの指定されたバージョンをインストールします。

例 1: TiUPを使用して、TiDB の最新の安定バージョンをインストールします。

```shell
tiup install tidb
```

例 2: TiUPを使用して、TiDB のナイトリー バージョンをインストールします。

```shell
tiup install tidb:nightly
```

例 3: TiUPを使用して TiKV v8.1.2 をインストールします。

```shell
tiup install tikv:v8.1.2
```

## コンポーネントのアップグレード {#upgrade-components}

コンポーネントの新しいバージョンが公開された後、 `tiup update`コマンドを使用してこのコンポーネントをアップグレードできます。このコマンドの使用方法は、次のフラグを除いて、基本的に`tiup install`と同じです。

-   `--all` : すべてのコンポーネントをアップグレードします。
-   `--nightly` : ナイトリーバージョンにアップグレードします。
-   `--self` : TiUP自体を最新バージョンにアップグレードします。
-   `--force` : 最新バージョンに強制的にアップグレードします。

例 1: すべてのコンポーネントを最新バージョンにアップグレードします。

```shell
tiup update --all
```

例 2: すべてのコンポーネントをナイトリー バージョンにアップグレードします。

```shell
tiup update --all --nightly
```

例 3: TiUP を最新バージョンにアップグレードします。

```shell
tiup update --self
```

## コンポーネントを操作する {#operate-components}

インストールが完了したら、 `tiup <component>`コマンドを使用して対応するコンポーネントを起動できます。

```shell
tiup [flags] <component>[:version] [args...]

Flags:
  -T, --tag string                     Specifies the tag for the component instance.
```

このコマンドを使用するには、コンポーネント名とオプションのバージョンを指定する必要があります。バージョンを指定しない場合は、このコンポーネントの最新の安定バージョン (インストール済み) が使用されます。

コンポーネントが起動する前に、 TiUP はコンポーネント用のディレクトリを作成し、このコンポーネントをそのディレクトリに配置して操作します。コンポーネントはこのディレクトリ内のすべてのデータを生成し、このディレクトリの名前はコンポーネントが動作するときに指定されたタグ名になります。タグが指定されていない場合は、タグ名がランダムに生成されます。この作業ディレクトリは、インスタンスが終了すると*自動的に削除され*ます。

同じコンポーネントを複数回起動し、前回の作業ディレクトリを再利用したい場合は、コンポーネント起動時に同じ名前を指定するために`--tag`使用します。タグを指定した後は、インスタンスを終了しても作業ディレクトリが*自動的に削除されなくなる*ため、作業ディレクトリを再利用するのに便利です。

例1: TiDB v8.1.2を操作します。

```shell
tiup tidb:v8.1.2
```

例 2: TiKV が動作するタグを指定します。

```shell
tiup --tag=experiment tikv
```

### コンポーネントの動作状態を照会する {#query-the-operating-status-of-a-component}

`tiup status`コマンドを使用して、コンポーネントの動作状態を確認できます。

```shell
tiup status
```

このコマンドを実行すると、インスタンスのリストが 1 行に 1 つずつ表示されます。リストには次の列が含まれます。

-   `Name` : インスタンスのタグ名。
-   `Component` : インスタンスのコンポーネント名。
-   `PID` : 動作中のインスタンスのプロセス ID。
-   `Status` : インスタンスのステータス。2 `RUNNING`インスタンスが動作中であることを意味します。4 `TERM`インスタンスが終了していることを意味します。
-   `Created Time` : インスタンスの開始時刻。
-   `Directory` : インスタンスの作業ディレクトリ。 `--tag`使用して指定できます。
-   `Binary` : インスタンスの実行可能プログラム。2 `--binpath`使用して指定できます。
-   `Args` : 操作インスタンスの引数。

### クリーンなコンポーネントインスタンス {#clean-component-instance}

`tiup clean`コマンドを使用して、コンポーネントインスタンスをクリーンアップし、作業ディレクトリを削除できます。クリーンアップ前にインスタンスがまだ動作している場合は、関連するプロセスが最初に強制終了されます。コマンドの使用方法は次のとおりです。

```bash
tiup clean [tag] [flags]
```

次のフラグがサポートされています:

-   `--all` : すべてのインスタンス情報をクリーンアップします。

上記のコマンドでは、 `tag`クリーンアップするインスタンス タグです。3 `--all`使用すると、タグは渡されません。

例 1: `experiment`タグ名を持つコンポーネントインスタンスをクリーンアップします。

```shell
tiup clean experiment
```

例 2: すべてのコンポーネントインスタンスをクリーンアップします。

```shell
tiup clean --all
```

### コンポーネントをアンインストールする {#uninstall-components}

TiUP を使用してインストールされたコンポーネントは、ローカル ディスク領域を占有します。古いバージョンのコンポーネントをあまり多く保持したくない場合は、現在インストールされているコンポーネントのバージョンを確認し、このコンポーネントをアンインストールすることができます。

`tiup uninstall`コマンドを使用して、コンポーネントのすべてのバージョンまたは特定のバージョンをアンインストールできます。このコマンドは、すべてのコンポーネントのアンインストールもサポートしています。コマンドの使用方法は次のとおりです。

```bash
tiup uninstall [component][:version] [flags]
```

このコマンドでは次のフラグがサポートされています。

-   `--all` : すべてのコンポーネントまたはバージョンをアンインストールします。
-   `--self` : TiUP自体をアンインストールします。

`component`アンインストールするコンポーネントです。2 `version`アンインストールするバージョンです。8 `tiup uninstall`では`component`と`version`どちらも無視できます。これら 2 つのいずれかを無視する場合は、 `--all`フラグを追加する必要があります。

-   バージョンが無視される場合、 `--all`追加すると、このコンポーネントのすべてのバージョンがアンインストールされます。
-   バージョンとコンポーネントの両方が無視される場合、 `--all`追加すると、すべてのバージョンのすべてのコンポーネントがアンインストールされます。

例 1: TiDB v8.1.2 をアンインストールします。

```shell
tiup uninstall tidb:v8.1.2
```

例 2: すべてのバージョンの TiKV をアンインストールします。

```shell
tiup uninstall tikv --all
```

例 3: インストールされているすべてのコンポーネントをアンインストールします。

```shell
tiup uninstall --all
```

### リンクコンポーネント {#link-components}

TiUP v1.13.0 では、コンポーネントのバイナリを実行可能ディレクトリ ( `$TIUP_HOME/bin/` ) にリンクしたり、リンクを削除したりするための実験的コマンド`link`と`unlink`追加されました。この機能により、異なるバージョン間の切り替え機能を維持しながら、毎回TiUPを経由せずにコンポーネントを呼び出すことができます。ただし、この方法では、自動更新チェックと特定の環境変数の設定のプロセスが欠如しており、一部のコンポーネント (ctl など) は使用できません。したがって、必要な場合にのみ使用することをお勧めします。

例1: クラスタコンポーネントの最新バージョンをインストールしてリンクする

```shell
tiup install cluster
tiup link cluster
```

例2: クラスターコンポーネントをバージョンv1.13.0に切り替える

```shell
tiup link cluster:v1.13.0
```

以下はコマンド`tiup link cluster`の出力です。

```shell
package cluster provides these executables: tiup-cluster
```

これは、クラスターコンポーネントのバイナリ名が`tiup-cluster`であることを示します。リンク コマンドが完了したら、コマンド ラインに`tiup-cluster`直接入力して、クラスターコンポーネントを使用できます。

例3: クラスターコンポーネントのリンクを解除する

```shell
tiup unlink cluster
```

例4: TiUPのバージョンを管理する

v1.13.0 より前では、 TiUPは`~/.tiup/bin/`にインストールされており、異なるバージョンは共存できません。v1.13.0 以降では、他のコンポーネントと同様にTiUP をインストールしてリンクできます。

```shell
tiup update --self # update tiup itself to a version that supports link
tiup link tiup:v1.13.0
```
